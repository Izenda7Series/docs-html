

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Load Balancing &mdash; Izenda BI 2.11.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Izenda BI 2.11.4 documentation" href="../../index.html"/>
        <link rel="up" title="Supplementary Guides" href="../.supplementary_installation_guides.html"/>
        <link rel="next" title="Language Packs" href="language-packs.html"/>
        <link rel="prev" title="Using SSL/TLS" href="https.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Izenda BI
          

          
            
            <img src="../../_static/logo2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                2.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro/.intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../.install.html">Installation and Maintenance Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../.stand_alone_deployment.html">Getting Started: Stand-alone Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../doc_upgrade_guide.html">Upgrade Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../.supplementary_installation_guides.html">Supplementary Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="doc_azure_evo.html">Pdf Exports in Azure Websites</a></li>
<li class="toctree-l3"><a class="reference internal" href="white-listing-functions-for-calculated-fields.html">White-Listing Functions for Calculated Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="white-labeling-izenda.html">White-Labeling Izenda</a></li>
<li class="toctree-l3"><a class="reference internal" href="https.html">Using SSL/TLS</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Load Balancing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scheduling">Scheduling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-packs.html">Language Packs</a></li>
<li class="toctree-l3"><a class="reference internal" href="excluding-sql-schemas.html">Excluding SQL Schemas</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging-to-a-database.html">Logging to a Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="security-configuration.html">Security Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="color-theme.html">Color theme for Chart, Gauge, and Map</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/.administrator_guide.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ui/.user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/.developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/.system_reference.html">System Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/.faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/.glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference external" href="http://wiki.izenda.us">6 Series Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Izenda BI</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../.install.html">Installation and Maintenance Guide</a> &raquo;</li>
        
          <li><a href="../.supplementary_installation_guides.html">Supplementary Guides</a> &raquo;</li>
        
      <li>Load Balancing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/install/supplementary_guides/load_balancing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="load-balancing">
<h1>Load Balancing<a class="headerlink" href="#load-balancing" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Izenda application can be load balanced to offer better performance and scalability.
The most common scenario would be to load balance the API among two or more servers. The diagram below assumes that SSL is terminated by the load balancer. To clarify, traffic to the load balancer is encrypted and the load balancer sends unencrypted traffic to the API server(s) in a trusted network</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple">
<li>Update the WebApiUrl value in the izenda_config.js file with the IP or host name of the load balancer.</li>
<li>Update the WebApiUrl in the [IzendaSystemSetting] table with the hostname or IP of the load balancer.</li>
</ol>
<div class="figure">
<img alt="../../_images/load-balancing1.png" src="../../_images/load-balancing1.png" />
</div>
</div>
<div class="section" id="scheduling">
<h2>Scheduling<a class="headerlink" href="#scheduling" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The Izenda Scheduler will store scheduling information in RAM of the server by default. If you are using any type of a distributed enviroment where there is more than one instance of the Izenda API (webfarms, etc.) you will need to use a database (ADO.NET job store) for storage of the scheduling information. Please follow the instructions below for setting up the scheduler to run in a distributed environment:</p>
<p>1. Download the creation script for your database type: <br clear="right" />
Download quartz database script ~databasetablestablessqlServer.sql inside Quartz.NET-2.3.3.zip. Use that script to create database quartzNET233 on your DB server. <a class="reference external" href="https://github.com/quartznet/quartznet/releases/tag/v2.3.3">https://github.com/quartznet/quartznet/releases/tag/v2.3.3</a> <br clear="right" /></p>
<ol class="arabic simple" start="2">
<li>Create the database (by default the table prefix &#8220;<a href="#id1"><span class="problematic" id="id2">QRTZ_</span></a>&#8221; but this can be set in the config) <br clear="right" /></li>
</ol>
<p>3. Add quartz config section into Web.config <br clear="right" />
&lt;section name=&#8221;quartz&#8221; type=&#8221;System.Configuration.NameValueSectionHandler&#8221; /&gt; <br clear="right" /></p>
<ol class="arabic simple" start="4">
<li>Add quartz section content into Web.config (under the  &lt;/system.webServer&gt; tag) and replace the value of config quartz.dataSource.QuartzNET_DS.connectionString by your server name (Server), user (User Id) and password (Password) to access quartzNET233 database. <br clear="right" /></li>
</ol>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span>  <span class="nt">&lt;quartz&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.scheduler.instanceName&quot;</span> <span class="na">value=</span><span class="s">&quot;Izenda_Quartz&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.scheduler.instanceId&quot;</span> <span class="na">value=</span><span class="s">&quot;Izenda_API&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.threadPool.threadCount&quot;</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.type&quot;</span> <span class="na">value=</span><span class="s">&quot;Quartz.Impl.AdoJobStore.JobStoreTX, Quartz&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.driverDelegateType&quot;</span> <span class="na">value=</span><span class="s">&quot;Quartz.Impl.AdoJobStore.SqlServerDelegate, Quartz&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.tablePrefix&quot;</span> <span class="na">value=</span><span class="s">&quot;QRTZ_&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.lockHandler.type&quot;</span> <span class="na">value=</span><span class="s">&quot;Quartz.Impl.AdoJobStore.UpdateLockRowSemaphore, Quartz&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.dataSource&quot;</span> <span class="na">value=</span><span class="s">&quot;QuartzNET_DS&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.dataSource.QuartzNET_DS.connectionString&quot;</span> <span class="na">value=</span><span class="s">&quot;[YOUR CONNECTION STRING HERE]&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- If you are using a database other than SQL Server, be sure to use the appropriate provider for your database</span>

<span class="c">                SqlServer-20 - SQL Server driver for .NET Framework 2.0</span>
<span class="c">                OracleODP-20 - Oracleâ€™s Oracle Driver</span>
<span class="c">                OracleODPManaged-1123-40 Oracleâ€™s managed driver for Oracle 11</span>
<span class="c">                OracleODPManaged-1211-40 Oracleâ€™s managed driver for Oracle 12</span>
<span class="c">                MySql-50 - MySQL Connector/.NET v. 5.0 (.NET 2.0)</span>
<span class="c">                MySql-51 - MySQL Connector/:NET v. 5.1 (.NET 2.0)</span>
<span class="c">                Npgsql-20 - PostgreSQL Npgsql</span>

<span class="c">                For more information, please consult the Quartz documentation:</span>
<span class="c">                https://www.quartz-scheduler.net/documentation/quartz-2.x/tutorial/job-stores.html --&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.dataSource.QuartzNET_DS.provider&quot;</span> <span class="na">value=</span><span class="s">&quot;SqlServer-20&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.useProperties&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.misfireThreshold&quot;</span> <span class="na">value=</span><span class="s">&quot;60000&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;add</span> <span class="na">key=</span><span class="s">&quot;quartz.jobStore.clustered&quot;</span> <span class="na">value=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/quartz&gt;</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Each instance in the cluster node should use the same copy of the quartz properties above except each node in the cluster MUST have a unique instanceId (quartz.scheduler.instanceId) <br clear="right" /></li>
<li>The datasource name is QuartzNET_DS, you can define whatever name you want, just note that it always come with config quartz.dataSource.QuartzNET_DS.xyz <br clear="right" /></li>
<li>Above are setting for MS SQL Server, if you want to use other DBMS you have to use correct database script for that DB type and must set correct quartz properties which are related to DB connection, that are quartz.jobStore.driverDelegateType, quartz.dataSource.QuartzNET_DS.connectionString, and quartz.dataSource.QuartzNET_DS.provider. Prefer JobStores tutorial chapter here <a class="reference external" href="https://www.quartz-scheduler.net/documentation/quartz-2.x/tutorial/job-stores.html">https://www.quartz-scheduler.net/documentation/quartz-2.x/tutorial/job-stores.html</a>). <br clear="right" /></li>
<li>To verify the config is correct or not on Izenda API, check the log file of all cluster nodes and make sure that there is only one node logs out the line contains &#8220;[Izenda_Quartz_Worker-###][INFO ][SubscriptionJob                     ] Start scheduling {#number} subscription jobs&#8221; <br clear="right" /></li>
</ul>
<ol class="arabic simple" start="5">
<li>After setting this configuration you will need to alter a setting in IzendaSystemSetting table as below: <br clear="right" /></li>
</ol>
<div class="highlight-sql"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">Update</span> <span class="n">IzendaSystemSetting</span>
<span class="k">Set</span> <span class="n">Value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">Where</span> <span class="n">Name</span> <span class="o">=</span> <span class="s1">&#39;UseADOJobStore&#39;</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="6">
<li>Then you will need to clear any schedules already running in memory to add them to the database using the Update statement below: <br clear="right" /></li>
</ol>
<div class="highlight-sql"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">UPDATE</span> <span class="n">IzendaSubscription</span> <span class="k">SET</span> <span class="n">IsScheduled</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
</pre></div>
</td></tr></table></div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">As general best practice, we recommend backing up your database before making any manual updates.</p>
</div>
<ol class="arabic simple" start="7">
<li>After making these changes, all API instances should be restarted.</li>
</ol>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="language-packs.html" class="btn btn-neutral float-right" title="Language Packs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="https.html" class="btn btn-neutral" title="Using SSL/TLS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Izenda.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2.11.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75560-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-75560-1');
</script>



</body>
</html>