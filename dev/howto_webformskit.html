

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building the Webforms Starter Kit &mdash; Izenda BI 3.11.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Izenda BI 3.11.4 documentation" href="../index.html"/>
        <link rel="up" title="&lt;no title&gt;" href=".walkthroughs.html"/>
        <link rel="next" title="Front End Rendering Considerations" href="dev_front_end_considerations.html"/>
        <link rel="prev" title="Deployment Mode 3: Building the MVC Starter Kit" href="howto_mvc5kit.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Izenda BI
          

          
            
            <img src="../_static/logo2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/.intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/.install.html">Installation and Maintenance Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/.administrator_guide.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/.user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href=".developer_guide.html">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/.system_reference.html">System Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/.faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/.glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference external" href="http://wiki.izenda.us">6 Series Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Izenda BI</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href=".developer_guide.html">Developer Guide</a> &raquo;</li>
        
          <li><a href=".embedding_izenda.html">First Steps</a> &raquo;</li>
        
          <li><a href=".walkthroughs.html">&lt;no title&gt;</a> &raquo;</li>
        
      <li>Building the Webforms Starter Kit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dev/howto_webformskit.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-the-webforms-starter-kit">
<h1><a class="toc-backref" href="#id14">Building the Webforms Starter Kit</a><a class="headerlink" href="#building-the-webforms-starter-kit" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#building-the-webforms-starter-kit" id="id14">Building the Webforms Starter Kit</a><ul>
<li><a class="reference internal" href="#introduction" id="id15">Introduction</a></li>
<li><a class="reference internal" href="#front-end-integration" id="id16">Front-end Integration</a><ul>
<li><a class="reference internal" href="#integrating-the-embedded-ui" id="id17">Integrating the Embedded UI</a></li>
<li><a class="reference internal" href="#the-izenda-integrate-js-file" id="id18">The Izenda.integrate.js file</a></li>
<li><a class="reference internal" href="#using-the-render-functions" id="id19">Using the render functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-handshake" id="id20">Security Handshake</a></li>
<li><a class="reference internal" href="#back-end-integration" id="id21">Back-end Integration</a><ul>
<li><a class="reference internal" href="#back-end-integration-through-c" id="id22">Back-end Integration through C#</a></li>
<li><a class="reference internal" href="#back-end-integration-through-the-api" id="id23">Back-end Integration through the API</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-integration-concepts" id="id24">Other Integration Concepts</a><ul>
<li><a class="reference internal" href="#white-labeling" id="id25">White Labeling</a></li>
<li><a class="reference internal" href="#deployment-modes" id="id26">Deployment Modes</a></li>
<li><a class="reference internal" href="#hidden-filters" id="id27">Hidden Filters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#webforms-integration" id="id28">Webforms Integration</a></li>
<li><a class="reference internal" href="#prerequisites" id="id29">Prerequisites</a></li>
<li><a class="reference internal" href="#create-your-webforms-starter-kit-application" id="id30">Create Your webforms Starter Kit Application</a></li>
<li><a class="reference internal" href="#copying-izenda-resources-and-references" id="id31">Copying Izenda Resources and References</a></li>
<li><a class="reference internal" href="#configuring-the-project-build" id="id32">Configuring the Project Build</a><ul>
<li><a class="reference internal" href="#add-izenda-dlls-reference-and-other-dependencies" id="id33">Add Izenda DLLs reference and other dependencies</a></li>
<li><a class="reference internal" href="#adding-post-build-events-to-copy-the-resources" id="id34">Adding post build events to copy the resources</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-the-script-and-style-bundle" id="id35">Configuring the Script and Style Bundle</a></li>
<li><a class="reference internal" href="#configuring-the-routes" id="id36">Configuring the Routes</a></li>
<li><a class="reference internal" href="#setting-up-the-database" id="id37">Setting up the Database</a><ul>
<li><a class="reference internal" href="#create-izenda-db" id="id38">Create Izenda DB</a></li>
<li><a class="reference internal" href="#updating-the-izenda-db" id="id39">Updating the Izenda DB</a></li>
<li><a class="reference internal" href="#create-authentication-db" id="id40">Create Authentication DB</a></li>
<li><a class="reference internal" href="#verifying-izenda-db-and-authentication-db" id="id41">Verifying Izenda DB and Authentication DB</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-the-izenda-api-service" id="id42">Configuring the Izenda API Service</a><ul>
<li><a class="reference internal" href="#izenda-api-service-hosting-config" id="id43">Izenda API Service Hosting Config</a></li>
<li><a class="reference internal" href="#logging-config" id="id44">Logging Config</a></li>
<li><a class="reference internal" href="#configuring-database-connection" id="id45">Configuring Database Connection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-first-run-of-izenda-api-service" id="id46">The first run of Izenda API Service</a><ul>
<li><a class="reference internal" href="#bit-oracle-dll-dependencies" id="id47">64-bit Oracle DLL Dependencies</a></li>
<li><a class="reference internal" href="#run-starter-kit" id="id48">Run Starter Kit</a></li>
<li><a class="reference internal" href="#izenda-api-hosting-troubleshooting" id="id49">Izenda API Hosting Troubleshooting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-izenda-boundary" id="id50">Adding Izenda Boundary</a></li>
<li><a class="reference internal" href="#custom-authentication-logic" id="id51">Custom Authentication Logic</a><ul>
<li><a class="reference internal" href="#izendaconfig" id="id52">IzendaConfig</a></li>
<li><a class="reference internal" href="#identity-models-namespaces" id="id53">Identity Models – Namespaces</a></li>
<li><a class="reference internal" href="#identity-models-applicationuser-class" id="id54">Identity Models – ApplicationUser class</a></li>
<li><a class="reference internal" href="#identity-models-tenant" id="id55">Identity Models – Tenant</a></li>
<li><a class="reference internal" href="#identity-models-applicationdbcontext" id="id56">Identity Models – ApplicationDBContext</a></li>
<li><a class="reference internal" href="#identity-config-namespaces" id="id57">Identity Config – Namespaces</a></li>
<li><a class="reference internal" href="#identity-config-applicationusermanager" id="id58">Identity Config – ApplicationUserManager</a></li>
<li><a class="reference internal" href="#identity-configs-applicationsigninmanager" id="id59">Identity Configs – ApplicationSignInManager</a></li>
<li><a class="reference internal" href="#app-start-webapiconfig" id="id60">App_Start - WebApiConfig</a></li>
<li><a class="reference internal" href="#login-aspx-cs-namespace" id="id61">Login.aspx.cs - Namespace</a></li>
<li><a class="reference internal" href="#login-aspx-cs" id="id62">Login.aspx.cs</a></li>
<li><a class="reference internal" href="#userinfo" id="id63">UserInfo</a></li>
<li><a class="reference internal" href="#update-login-page" id="id64">Update Login Page</a></li>
<li><a class="reference internal" href="#apicontrollers-usercontroller" id="id65">ApiControllers - UserController</a></li>
<li><a class="reference internal" href="#global-asax-cs" id="id66">global.asax.cs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-first-login" id="id67">Run First Login</a></li>
<li><a class="reference internal" href="#update-shared-layout" id="id68">Update Shared Layout</a><ul>
<li><a class="reference internal" href="#construct-izenda-menu-items" id="id69">Construct Izenda Menu Items</a></li>
<li><a class="reference internal" href="#implement-izenda-configuration-initialization" id="id70">Implement Izenda Configuration Initialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#embedding-front-end-izenda-izenda-ui" id="id71">Embedding Front-end Izenda (Izenda UI)</a><ul>
<li><a class="reference internal" href="#embedding-izenda-full-page" id="id72">Embedding Izenda full page</a></li>
<li><a class="reference internal" href="#embedding-specific-izenda-pages" id="id73">Embedding Specific Izenda Pages</a><ul>
<li><a class="reference internal" href="#embedding-the-izenda-settings-page" id="id74">Embedding the Izenda Settings Page</a></li>
<li><a class="reference internal" href="#embedding-the-izenda-report-list-page" id="id75">Embedding the Izenda Report List Page</a></li>
<li><a class="reference internal" href="#embedding-the-izenda-report-designer-page" id="id76">Embedding the Izenda Report Designer Page</a></li>
<li><a class="reference internal" href="#report-part-for-exporting" id="id77">Report Part for Exporting</a></li>
<li><a class="reference internal" href="#embedding-the-report-viewer" id="id78">Embedding the Report Viewer</a></li>
<li><a class="reference internal" href="#embedding-report-parts" id="id79">Embedding Report Parts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#embedding-the-dashboard" id="id80">Embedding the Dashboard</a><ul>
<li><a class="reference internal" href="#dashboard-list" id="id81">Dashboard List</a></li>
<li><a class="reference internal" href="#new-dashboard" id="id82">New Dashboard</a></li>
<li><a class="reference internal" href="#dashboard-viewer" id="id83">Dashboard Viewer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#run-your-izenda-integrated-application" id="id84">Run Your Izenda Integrated Application</a></li>
<li><a class="reference internal" href="#implement-register-new-account" id="id85">Implement Register New Account</a></li>
<li><a class="reference internal" href="#call-the-izenda-api-service-in-c" id="id86">Call the Izenda API Service in C#</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id15">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This guide will give you an overview of the major aspects of an Izenda integration with a webforms web application.</p>
<p>The purpose of the guide is to abstract from the core of the Izenda Webforms Starter Kit guide the overarching concepts of back end and front-end integration.</p>
<p>Many of the concepts executed upon in the integration sections of this guide can be re-used in other applications, .NET or otherwise.</p>
<p>The three major features of an Izenda integration, and the three major sections of this summary section are as follows:</p>
<ul class="simple">
<li>Front-end Integration</li>
<li>Security Handshake</li>
<li>Back-end Integration</li>
</ul>
</div>
<div class="section" id="front-end-integration">
<h2><a class="toc-backref" href="#id16">Front-end Integration</a><a class="headerlink" href="#front-end-integration" title="Permalink to this headline">¶</a></h2>
<p>Front-end integration with Izenda involves taking the EmbeddedUI codebase and integrating it with an existing application’s front-end codebase and placing it behind that application’s authentication process.</p>
<p>Izenda’s EmbeddedUI is based upon the ReactJS framework. It is lightweight, easy to embed, and works with most modern web technologies, whether it’s another JavaScript framework like Angular, or application technologies like .NET, Java, PHP, Python, or Ruby.</p>
<p>The EmbeddedUI provides access to the Izenda Synergy JavaScript function library which allows for easy rendering of Izenda’s front-end containers throughout the target application.</p>
<p>You can learn more about the IzendaSynergy configuration, authentication, and render functions in the <a class="reference internal" href="api_frontend_integration.html"><span class="doc">Front-end Integration API documentation</span></a>.</p>
<div class="section" id="integrating-the-embedded-ui">
<h3><a class="toc-backref" href="#id17">Integrating the Embedded UI</a><a class="headerlink" href="#integrating-the-embedded-ui" title="Permalink to this headline">¶</a></h3>
<p>This is as simple as just dropping in the Izenda EmbeddedUI Code base.</p>
<p>Once the Izenda ReactJS library is present you’ll have direct access to the IzendaSynergy render functions.</p>
<p>This is done in the <a class="reference internal" href="#copying-izenda-resources-and-references">Copying Izenda Resources and References</a> section of the guide below.</p>
</div>
<div class="section" id="the-izenda-integrate-js-file">
<h3><a class="toc-backref" href="#id18">The Izenda.integrate.js file</a><a class="headerlink" href="#the-izenda-integrate-js-file" title="Permalink to this headline">¶</a></h3>
<p>This file is a good representation of how to bundle together IzendaSynergy configuration, authentication, and render functions.</p>
<p>You may choose to create a similar file in your own application code base as it greatly simplifies the amount of on page code you might write to manage your resource references, API endpoint references, passing of the Izenda currentusercontext token, and specific render function.</p>
<p>This is done in the <a class="reference internal" href="#copying-izenda-resources-and-references">Copying Izenda Resources and References</a> section of the guide below.</p>
<p>You can view the contents of Izenda.integrate.js <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Scripts/izenda.integrate.js">here</a>.</p>
</div>
<div class="section" id="using-the-render-functions">
<h3><a class="toc-backref" href="#id19">Using the render functions</a><a class="headerlink" href="#using-the-render-functions" title="Permalink to this headline">¶</a></h3>
<p>Once the EmbeddedUI front-end resources are in place, and we’ve configured the configuration, authentication, and render functions. The last thing to do is use these bundled JavaScript functions within our application’s front-end to render specific Izenda containers/pages.</p>
<p>This is done in the <a class="reference external" href="EmbeddingFront-endIzenda(IzendaUI)">Embedded Front-end</a> section of the guide below.</p>
</div>
</div>
<div class="section" id="security-handshake">
<h2><a class="toc-backref" href="#id20">Security Handshake</a><a class="headerlink" href="#security-handshake" title="Permalink to this headline">¶</a></h2>
<p>The basic Izenda security handshake is handled through a token which contains two key pieces of user metadata, a unique user identifier, and a unique tenant identifier. You’ll handle role level details through the back-end integration.</p>
<p>The point here is to create the medium through which Izenda will authenticate interactions between the front-end and back-end API endpoints.</p>
<p>In the <a class="reference internal" href="#izendaconfig">IzendaConfig</a> we’ll create the token for the end-user authentication that will eventually be passed to Izenda’s API endpoints through IzendaSynergy currentUserContext.</p>
<p>As you’ll see in that section, that token contains two values originating from the application’s tenant and user store.</p>
<p>We then pass these values through the token we create along with Izenda’s render functions in the Izenda.integrate.js file.</p>
<p>There is no separate login process for Izenda specifically, rather Izenda just sits behind the existing application’s authentication process and inherits a few key values.</p>
<p>You can see an example of the token getting passed into Izenda’s currentUserContext in <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Scripts/izenda.integrate.js">izenda.integrate.js</a>.</p>
<p>Most of the work here is done in the <a class="reference internal" href="#custom-authentication-logic">Custom Authentication Logic</a> section of the guide below.</p>
<p>There is work beyond just generating the handshake token in that section, as there is additional configuration being done specific to the application to add a Tenant concept to its security model.</p>
</div>
<div class="section" id="back-end-integration">
<h2><a class="toc-backref" href="#id21">Back-end Integration</a><a class="headerlink" href="#back-end-integration" title="Permalink to this headline">¶</a></h2>
<p>Through front-end integration we are rendering pages, parts, and containers. Through the security handshake we are placing Izenda behind an existing authentication process.</p>
<p>Through back-end integration we are using hooks within Izenda to inherit an existing security model.</p>
<p>The basic concept here is that we want to populate existing tenant, role, and user associations in Izenda.</p>
<p>Now, when users are authenticated, Izenda will be able to appropriately govern what data, features, and reports or dashboards it might expose to the end-user. You can also define these permissions through the EmbeddedUI interfaces, C#, or API endpoints.</p>
<p>This can be done through either exposed C# methods, or through REST API endpoints.</p>
<div class="section" id="back-end-integration-through-c">
<h3><a class="toc-backref" href="#id22">Back-end Integration through C#</a><a class="headerlink" href="#back-end-integration-through-c" title="Permalink to this headline">¶</a></h3>
<p>This method of back-end integration is typically done when integrating with other .NET web applications, however you might use this approach in scenarios where you would want Izenda to pull (through LINQ expressions, SQL Queries, Web Services, or other REST APIs) the Tenant, Role, and User Metadata you would like Izenda to inherit.</p>
<p><a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit">Sample Starter Kit</a></p>
<p>The Webforms Starter Kit demonstrates the C# method approach in depth. This application has both the Izenda EmbeddedUI and API as a part of its codebase, with no components of Izenda running separately.</p>
<p>Most of the interaction is done in the <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Account/Register.aspx.cs">Register.aspx code-behind</a>.</p>
<p>In that file, you can see several references to Izenda DLLs which provide access to exposed methods and classes that are relevant to managing Tenants, Roles, and Users programmatically.</p>
<p>We are syncing between the webforms application’s security model and Izenda’s to make them essentially equivalent.</p>
<p>You can see starting <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Account/Register.aspx.cs#L20">here</a> that we are using methods to pass values directly from the webforms application’s security model into Izenda’s by equivocating the webforms application’s Tenant, Role, and User variables with Izenda’s. While some areas of this code contain hard-coded values, in real world implementations those values would get replaced with variables or lookups.</p>
<p>Much of the code used in the register page&#8217;s logic is supported by contents of the <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/tree/master/WebFormsStarterKit/IzendaBoundary">IzendaBoundary</a> directory and <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/tree/master/WebFormsStarterKit/Models">Models</a> from the webforms kit.</p>
</div>
<div class="section" id="back-end-integration-through-the-api">
<h3><a class="toc-backref" href="#id23">Back-end Integration through the API</a><a class="headerlink" href="#back-end-integration-through-the-api" title="Permalink to this headline">¶</a></h3>
<p>Currently there is no webforms kit that implements Izenda through REST API calls. For an example that uses the REST API, you can review the <a class="reference external" href="https://www.izenda.com/docs/dev/dev_dep_1_key_components.html">MVC5 back-end standalone</a> documentation and example kit to learn about that approach.</p>
</div>
</div>
<div class="section" id="other-integration-concepts">
<h2><a class="toc-backref" href="#id24">Other Integration Concepts</a><a class="headerlink" href="#other-integration-concepts" title="Permalink to this headline">¶</a></h2>
<p>Beyond front-end, handshake, and back-end, there’s of course an expectation that you’ll want to white label Izenda, integrate with a specific deployment model, and manage record level data permissions beyond what you might define at a Tenant and Role level in Izenda.</p>
<p>There are many more capabilities and features you may want to explore.</p>
<p>Please reference our GitHub, documentation site, and developer guides for more:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/Izenda7Series">GitHub</a></li>
<li><a class="reference internal" href="../index.html"><span class="doc">Izenda Docs</span></a></li>
<li><a class="reference internal" href=".developer_guide.html"><span class="doc">Developer Guide</span></a></li>
</ul>
<div class="section" id="white-labeling">
<h3><a class="toc-backref" href="#id25">White Labeling</a><a class="headerlink" href="#white-labeling" title="Permalink to this headline">¶</a></h3>
<p>Izenda provides a fully exposed presentation layer, which includes exposed CSS files.</p>
<p><a class="reference external" href="https://www.izenda.com/docs/dev/code_bi_portal_custom_css.html">Customizing Izenda’s CSS</a></p>
</div>
<div class="section" id="deployment-modes">
<h3><a class="toc-backref" href="#id26">Deployment Modes</a><a class="headerlink" href="#deployment-modes" title="Permalink to this headline">¶</a></h3>
<p>You may need to integrate only specific areas of Izenda’s codebase, depending upon your integration goals, deployment style, and application technology.</p>
<p><a class="reference internal" href="../intro/understanding_the_three-tiered_architecture.html"><span class="doc">Understanding The Three-tiered Architecture</span></a>.</p>
</div>
<div class="section" id="hidden-filters">
<h3><a class="toc-backref" href="#id27">Hidden Filters</a><a class="headerlink" href="#hidden-filters" title="Permalink to this headline">¶</a></h3>
<p>Hidden Filters in Izenda are the mechanism by which you can dynamically append to the WHERE clause of Izenda’s queries to ensure it only pulls back highly personalized record sets from your data sources.</p>
<p>See: <a class="reference internal" href="ref_iadhocextension.html#sethiddenfilters"><span class="std std-ref">SetHiddenFilters</span></a>.</p>
</div>
</div>
<div class="section" id="webforms-integration">
<h2><a class="toc-backref" href="#id28">Webforms Integration</a><a class="headerlink" href="#webforms-integration" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will teach you the basics of embedding Izenda into an ASP.NET webforms application using Visual Studio 2015.</p>
<p>Download the <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit">completed project</a>. This is important! You’ll need to use files and code samples from this codebase throughout the guide.</p>
<p>This starter kit will guide you through the implementation and deployment of the full integration mode, this means both front-end (UI) and back-end (API Service) are integrated into one webforms application.</p>
<p>See more details for <a class="reference internal" href="../intro/understanding_the_three-tiered_architecture.html#fully-integrated-deployment"><span class="std std-ref">Deployment Mode 1: Back End Standalone, Front End Integrated</span></a>.</p>
</div>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#id29">Prerequisites</a><a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>To complete this walkthrough, you will need the following:</p>
<ul class="simple">
<li>Visual Studio 2015</li>
<li>.NET Version 4.5.2</li>
<li>Izenda API package</li>
<li>Izenda Embedded UI package</li>
<li>Sql Server 2016</li>
</ul>
<p>The Izenda API service is built on .NET framework 4.0. You can build your integrated application on .NET Framework 4.0 or higher to be compatible with the Izenda API. This document will guide you step by step on integrating Izenda into your application. Please note this guide was developed using the versions of each component specified above. For more details on supported components please see other sections in the <a class="reference internal" href="../index.html"><span class="doc">Izenda documentation</span></a>.</p>
</div>
<div class="section" id="create-your-webforms-starter-kit-application">
<h2><a class="toc-backref" href="#id30">Create Your webforms Starter Kit Application</a><a class="headerlink" href="#create-your-webforms-starter-kit-application" title="Permalink to this headline">¶</a></h2>
<p>Open Visual Studio IDE then select menu New &gt; New Project</p>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="../_images/mvc_new_project.png"><img alt="../_images/mvc_new_project.png" src="../_images/mvc_new_project.png" style="width: 509px;" /></a>
<p class="caption"><span class="caption-number">Fig. 432 </span><span class="caption-text">New ASP.NET Web Application</span></p>
</div>
<p>On New Project dialog, select Templates &gt; Visual C# &gt; Web then select target .NET Framework and ASP.NET Web Application.</p>
<p>Name your project “WebFormsStarterKit” then click OK. This is important! It will affect reference names throughout the code base.</p>
<p>In the New ASP.NET Project dialog, click Web Forms and click Change Authentication then chose Individual User Accounts, click OK buttons to close dialogs.</p>
<div class="figure" id="id2">
<a class="reference internal image-reference" href="../_images/webforms_new_project.png"><img alt="../_images/webforms_new_project.png" src="../_images/webforms_new_project.png" style="width: 590px;" /></a>
<p class="caption"><span class="caption-number">Fig. 433 </span><span class="caption-text">Web Forms Template</span></p>
</div>
<p>The default template of a webforms application will be created. You will use this template to implement Izenda fully integrated into the application.</p>
</div>
<div class="section" id="copying-izenda-resources-and-references">
<h2><a class="toc-backref" href="#id31">Copying Izenda Resources and References</a><a class="headerlink" href="#copying-izenda-resources-and-references" title="Permalink to this headline">¶</a></h2>
<p>In Solution Explorer of WebFormsStarterKit project, add new folders below:</p>
<ul class="simple">
<li>IzendaBoundary</li>
<li>IzendaReferences</li>
<li>IzendaResources</li>
<li>Scripts\izenda</li>
</ul>
<p>Copy Izenda Resource to starter kit project:</p>
<ul class="simple">
<li>Download and copy <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/izendadb.config">izendadb.config</a> file into ~\WebFormsStarterKit</li>
<li>Download latest Izenda API package (API.zip) extract zip file and then:<ul>
<li>Copy all sub folders and files in ~\API\bin to ~ \WebFormsStarterKit\IzendaReferences</li>
<li>Copy 3 folders API\Content, API\EmailTemplates and API\Export to ~ \WebFormsStarterKit\IzendaResources</li>
</ul>
</li>
<li>Download latest Izenda Embedded UI package (EmbeddedUI.zip), extract zip file then copy all sub folders and files to ~\WebFormsStarterKit\Scripts\izenda</li>
<li>Download <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Scripts/izenda.integrate.js">izenda.integrate.js</a>, <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Scripts/izenda.utils.js">izenda.utils.js</a> and <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Scripts/alertify.js">alertify.js</a> then copy to ~\WebFormsStarterKit\Scripts</li>
<li>Download <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Content/alertify.css">alertify.css</a> and copy to ~\WebFormsStarterKit\Content</li>
</ul>
</div>
<div class="section" id="configuring-the-project-build">
<h2><a class="toc-backref" href="#id32">Configuring the Project Build</a><a class="headerlink" href="#configuring-the-project-build" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-izenda-dlls-reference-and-other-dependencies">
<h3><a class="toc-backref" href="#id33">Add Izenda DLLs reference and other dependencies</a><a class="headerlink" href="#add-izenda-dlls-reference-and-other-dependencies" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Right click Reference node in the WebFormsStarterKit Solution Explorer then select Add Reference…</p>
<div class="figure" id="id3">
<a class="reference internal image-reference" href="../_images/webforms_add_reference.png"><img alt="../_images/webforms_add_reference.png" src="../_images/webforms_add_reference.png" style="width: 361px;" /></a>
<p class="caption"><span class="caption-number">Fig. 434 </span><span class="caption-text">Add reference</span></p>
</div>
</li>
<li><p class="first">On Reference Manager dialog click Browse… button then browse to folder ~\WebFormsStarterKit\IzendaReferences, select all DLL files to reference but ignore below dlls (because those dlls have already been referenced in the webforms project template by default):</p>
<ul class="simple">
<li>Microsoft.Web.Infrastructure.dll</li>
<li>Newtonsoft.Json.dll</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this step if you encounter errors regarding reference conflicts, you must configure Redirecting Assembly as required or contact Izenda Support.</p>
</div>
</li>
<li><p class="first">You also need to add System.ComponentModel.Composition. <br clear="right" />
Go to Add References again, Assemblies-&gt; Framework and check System.ComponentModel.Composition.</p>
</li>
<li><p class="first">Finally, go to Tools-&gt;NuGet Packet Manager-&gt;Package Manager Console and run the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Install-Package Microsoft.AspNet.WebApi.Client</span>
<span class="go">Install-Package Microsoft.AspNet.WebApi.Core</span>
<span class="go">Install-Package Microsoft.AspNet.WebApi.WebHost</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="adding-post-build-events-to-copy-the-resources">
<h3><a class="toc-backref" href="#id34">Adding post build events to copy the resources</a><a class="headerlink" href="#adding-post-build-events-to-copy-the-resources" title="Permalink to this headline">¶</a></h3>
<p>Adding post build events to copy the resources
Open Project Properties page select Build Events then click Edit Post-build… button and then enter the commands below into Post-build event command line box:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">XCOPY /S /I /Y  &quot;$(ProjectDir)IzendaResources\Content&quot; &quot;$(ProjectDir)\bin\Content\&quot;</span>
<span class="go">XCOPY /S /I /Y  &quot;$(ProjectDir)IzendaResources\EmailTemplates&quot; &quot;$(ProjectDir)\bin\EmailTemplates\&quot;</span>
<span class="go">XCOPY /S /I /Y  &quot;$(ProjectDir)IzendaResources\Export&quot; &quot;$(ProjectDir)\bin\Export\&quot;</span>
</pre></div>
</div>
<div class="figure" id="id4">
<a class="reference internal image-reference" href="../_images/webforms_post_build_events.png"><img alt="../_images/webforms_post_build_events.png" src="../_images/webforms_post_build_events.png" style="width: 806px;" /></a>
<p class="caption"><span class="caption-number">Fig. 435 </span><span class="caption-text">Copy Resources on Post build event</span></p>
</div>
</div>
</div>
<div class="section" id="configuring-the-script-and-style-bundle">
<h2><a class="toc-backref" href="#id35">Configuring the Script and Style Bundle</a><a class="headerlink" href="#configuring-the-script-and-style-bundle" title="Permalink to this headline">¶</a></h2>
<p>Open ~\WebFormsStarterKit\App_Start\BundleConfig.cs then config for Izenda as below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>            <span class="n">bundles</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">ScriptBundle</span><span class="p">(</span><span class="s2">&quot;~/bundles/jquery&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Include</span><span class="p">(</span>
                        <span class="s2">&quot;~/Scripts/jquery-</span><span class="si">{version}</span><span class="s2">.js&quot;</span><span class="p">));</span>

            <span class="n">bundles</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">ScriptBundle</span><span class="p">(</span><span class="s2">&quot;~/bundles/bootstrap&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Include</span><span class="p">(</span>
                      <span class="s2">&quot;~/Scripts/bootstrap.js&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;~/Scripts/respond.js&quot;</span><span class="p">));</span>

            <span class="o">//</span> <span class="c1">#izenda</span>
            <span class="n">bundles</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">ScriptBundle</span><span class="p">(</span><span class="s2">&quot;~/bundles/izenda&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Include</span><span class="p">(</span>
                       <span class="s2">&quot;~/Scripts/izenda/izenda_common.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/izenda/izenda_locales.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/izenda/izenda_vendors.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/izenda/izenda_ui.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/izenda.integrate.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/izenda.utils.js&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;~/Scripts/alertify.js&quot;</span><span class="p">));</span>

</pre></div>
</div>
<p><a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/App_Start/BundleConfig.cs">View Code Here</a></p>
<p>Open ~\Site.master and add CSS and bundle scripts:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;&lt;%</span><span class="p">:</span> <span class="n">Page</span><span class="o">.</span><span class="n">Title</span> <span class="o">%&gt;</span> <span class="o">-</span> <span class="n">My</span> <span class="n">ASP</span><span class="o">.</span><span class="n">NET</span> <span class="n">Application</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>

	<span class="o">&lt;%--</span><span class="n">Apply</span> <span class="n">css</span> <span class="k">for</span> <span class="n">izenda</span><span class="o">--%&gt;</span>
<span class="hll">    <span class="o">&lt;</span><span class="n">link</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;~/Scripts/izenda/izenda-ui.css&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="o">&gt;</span>
</span>	
    <span class="o">&lt;</span><span class="n">link</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;~/favicon.ico&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;shortcut icon&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;image/x-icon&quot;</span> <span class="o">/&gt;</span>

    <span class="o">&lt;</span><span class="n">webopt</span><span class="p">:</span><span class="n">bundlereference</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;~/Content/css&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">PlaceHolder</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;%</span><span class="p">:</span> <span class="n">Scripts</span><span class="o">.</span><span class="n">Render</span><span class="p">(</span><span class="s2">&quot;~/bundles/modernizr&quot;</span><span class="p">)</span> <span class="o">%&gt;</span>
        <span class="o">&lt;%--</span><span class="n">Izenda</span><span class="o">--%&gt;</span>
<span class="hll">        <span class="o">&lt;%</span><span class="p">:</span> <span class="n">Scripts</span><span class="o">.</span><span class="n">Render</span><span class="p">(</span><span class="s2">&quot;~/bundles/jquery&quot;</span><span class="p">)</span> <span class="o">%&gt;</span>
</span><span class="hll">        <span class="o">&lt;%</span><span class="p">:</span> <span class="n">Scripts</span><span class="o">.</span><span class="n">Render</span><span class="p">(</span><span class="s2">&quot;~/bundles/bootstrap&quot;</span><span class="p">)</span> <span class="o">%&gt;</span>
</span><span class="hll">        <span class="o">&lt;%</span><span class="p">:</span> <span class="n">Scripts</span><span class="o">.</span><span class="n">Render</span><span class="p">(</span><span class="s2">&quot;~/bundles/izenda&quot;</span><span class="p">)</span> <span class="o">%&gt;</span>
</span><span class="hll">    <span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">PlaceHolder</span><span class="o">&gt;</span>
</span></pre></div>
</div>
</div>
<div class="section" id="configuring-the-routes">
<h2><a class="toc-backref" href="#id36">Configuring the Routes</a><a class="headerlink" href="#configuring-the-routes" title="Permalink to this headline">¶</a></h2>
<p>Open ~\WebFormsStarterKit\App_Start\RouteConfig.cs then modify the routing config as shown below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">public</span> <span class="n">static</span> <span class="k">class</span> <span class="nc">RouteConfig</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">RegisterRoutes</span><span class="p">(</span><span class="n">RouteCollection</span> <span class="n">routes</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="o">//</span> <span class="n">This</span> <span class="n">route</span> <span class="ow">is</span> <span class="n">used</span> <span class="k">for</span> <span class="n">exporting</span> <span class="n">image</span> <span class="kn">from</span> <span class="nn">html</span> <span class="n">content</span>
            <span class="n">routes</span><span class="o">.</span><span class="n">MapPageRoute</span><span class="p">(</span><span class="s2">&quot;ReportPart&quot;</span><span class="p">,</span> <span class="s2">&quot;viewer/reportpart/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;~/Report/ReportPart.aspx&quot;</span><span class="p">);</span>

            <span class="o">//</span> <span class="n">This</span> <span class="n">route</span> <span class="ow">is</span> <span class="n">used</span> <span class="k">for</span> <span class="n">exporting</span> <span class="n">subscription</span> <span class="n">report</span>
            <span class="n">routes</span><span class="o">.</span><span class="n">MapPageRoute</span><span class="p">(</span><span class="s2">&quot;ReportViewer&quot;</span><span class="p">,</span> <span class="s2">&quot;report/view/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;~/Report/ReportViewer.aspx&quot;</span><span class="p">);</span>

            <span class="o">//</span> <span class="n">This</span> <span class="n">route</span> <span class="ow">is</span> <span class="n">used</span> <span class="k">for</span> <span class="n">exporting</span> <span class="n">subscription</span> <span class="n">dashboard</span>
            <span class="n">routes</span><span class="o">.</span><span class="n">MapPageRoute</span><span class="p">(</span><span class="s2">&quot;DashboardViewer&quot;</span><span class="p">,</span> <span class="s2">&quot;dashboard/view/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;~/Dashboard/DashboardViewer.aspx&quot;</span><span class="p">);</span>

            <span class="n">routes</span><span class="o">.</span><span class="n">Ignore</span><span class="p">(</span><span class="s2">&quot;izapi/{*pathInfo}&quot;</span><span class="p">);</span>

            <span class="n">var</span> <span class="n">settings</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FriendlyUrlSettings</span><span class="p">();</span>
            <span class="n">settings</span><span class="o">.</span><span class="n">AutoRedirectMode</span> <span class="o">=</span> <span class="n">RedirectMode</span><span class="o">.</span><span class="n">Permanent</span><span class="p">;</span>
            <span class="n">routes</span><span class="o">.</span><span class="n">EnableFriendlyUrls</span><span class="p">(</span><span class="n">settings</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/App_Start/RouteConfig.cs">View Code Here</a></p>
<p>The statement <code class="docutils literal"><span class="pre">routes.IgnoreRoute(&quot;izapi/{*pathInfo}&quot;)</span></code> is important, do not miss it. This route will instruct the web infrastructure routine to ignore any request API that begins with the <code class="docutils literal"><span class="pre">izapi/</span></code> prefix (instead of handling the request as a route, the application will treat it as an API Service request), and this prefix must have the same value as the Izenda API prefix setting <code class="docutils literal"><span class="pre">&lt;add</span> <span class="pre">key=&quot;izendaapiprefix&quot;</span> <span class="pre">value=&quot;izapi&quot;</span> <span class="pre">/&gt;</span></code> that you will configure in the section <a class="reference internal" href="#izenda-api-service-hosting-config">Izenda API Service Hosting Config</a> later.</p>
<p>Some of the routing configuration may seem strange, but it will be explained later. The table below details the purpose of each URL route:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="25%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">URL</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ReportPart</td>
<td>viewer/reportpart/{id}</td>
<td>This route is used by the Izenda BE Service to capture html content of the report part types chart, gauge or map. Mostly used for report exporting functions.</td>
</tr>
<tr class="row-odd"><td>ReportViewer</td>
<td>report/view/{id}</td>
<td>This route is used by the Izenda BE Service to capture report content in html format. It is using in exporting report content to embedded html and sending it to email (send to email directly or send via the report subscription function).</td>
</tr>
<tr class="row-even"><td>DashboardViewer</td>
<td>dashboard/view/{id}</td>
<td>The route used by the Izenda BE Service to capture dashboard content in html format. Used for exporting dashboard content to email.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="setting-up-the-database">
<h2><a class="toc-backref" href="#id37">Setting up the Database</a><a class="headerlink" href="#setting-up-the-database" title="Permalink to this headline">¶</a></h2>
<p>In this starter kit, we use SQL Server for the database server. Izenda supports many database engines such as: [MSSQL] SQL Server, [AZSQL] AzureSQL, [MYSQL] MySQL, [ORACL] Oracle, and [PGSQL] PostgreSQL. The steps to setting up these databases are similar.</p>
<div class="section" id="create-izenda-db">
<h3><a class="toc-backref" href="#id38">Create Izenda DB</a><a class="headerlink" href="#create-izenda-db" title="Permalink to this headline">¶</a></h3>
<p>On your SQL Server, create an empty database named IzendaWebForms. This database stores Izenda data (report definitions, dashboards, etc.) and the configuration necessary to run Izenda.</p>
<p>Download <a class="reference external" href="https://raw.githubusercontent.com/Izenda7Series/WebFormsStarterkit/master/SQLScript/MSSQL/IzendaWebForms.sql">IzendaWebForms.sql</a> then execute the script on your IzendaWebForms database to generate the schema and default data.</p>
</div>
<div class="section" id="updating-the-izenda-db">
<h3><a class="toc-backref" href="#id39">Updating the Izenda DB</a><a class="headerlink" href="#updating-the-izenda-db" title="Permalink to this headline">¶</a></h3>
<p>The IzendaWebForms.sql script will generate a configuration database for Izenda 2.6.20.</p>
<p>If you use an EmbeddedUI and API for a later version of Izenda you will need to run update scripts against your IzendaWebForms database. You can find a tool to generate the required scripts <a class="reference external" href="https://tools.izenda.com/">here</a>.</p>
<p>For example, if you deploy version 2.11.1 of the EmbeddedUI and API, you would select v2.6.20 as your current version and v2.11.1 as your target version and (for the purposes of this tutorial) [MSSQL] SQLServer as your database type. You can choose to download the script as a SQL file or (if the check box is unchecked) view the file directly in your browser window.</p>
</div>
<div class="section" id="create-authentication-db">
<h3><a class="toc-backref" href="#id40">Create Authentication DB</a><a class="headerlink" href="#create-authentication-db" title="Permalink to this headline">¶</a></h3>
<p>On your SQL Server, create an empty database named WebFormsStarterKit. This database is used for storing user authentication information for the webforms kit. In your real integrated application, it can be replaced by your system database with your custom user credential information.</p>
<p>Download <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/SQLScript/MSSQL/WebFormsStarterKit.sql">WebFormsStarterKit.sql</a> and execute the script on your WebFormsStarterKit database to generate the schema and default user authentication settings. These settings mirror the Izenda configuration database user data as closely as possible.</p>
</div>
<div class="section" id="verifying-izenda-db-and-authentication-db">
<h3><a class="toc-backref" href="#id41">Verifying Izenda DB and Authentication DB</a><a class="headerlink" href="#verifying-izenda-db-and-authentication-db" title="Permalink to this headline">¶</a></h3>
<p>After creating the IzendaDB, select all rows in the IzendaSystemSetting table and verify that the values are the same as below:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>DeploymentMode</td>
<td>3</td>
<td>The setting for deployment mode, in this starter kit it is fully integrated.</td>
</tr>
<tr class="row-odd"><td>WebUrl</td>
<td><a class="reference external" href="http://localhost:14909/">http://localhost:14909/</a></td>
<td>The setting value must be the base address of your front-end web page url.</td>
</tr>
</tbody>
</table>
<p>Next you must ensure the UserName value of the records in the AspNetUsers table in WebFormsStarterKit DB are matched with the UserName value in the IzendaUser table of IzendaWebForms DB.</p>
</div>
</div>
<div class="section" id="configuring-the-izenda-api-service">
<h2><a class="toc-backref" href="#id42">Configuring the Izenda API Service</a><a class="headerlink" href="#configuring-the-izenda-api-service" title="Permalink to this headline">¶</a></h2>
<p>The full configuration file <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Web.config">Web.config</a> of Izenda API Service is available on GitHub.</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/Izenda7Series/WebFormsStarterkit/master/WebFormsStarterKit/Web.config">View Code Here</a></p>
<div class="section" id="izenda-api-service-hosting-config">
<h3><a class="toc-backref" href="#id43">Izenda API Service Hosting Config</a><a class="headerlink" href="#izenda-api-service-hosting-config" title="Permalink to this headline">¶</a></h3>
<p>Izenda uses the Nancy Framework to host the REST API service. To configure Nancy, open the WebFormsStarterKit\Web.config and add a new section like below:</p>
<p>Then add the following email config after <code class="docutils literal"><span class="pre">&lt;/nancyFx&gt;</span></code> close tag:</p>
<p>Add below Izenda setting key into &lt;appSettings&gt; node:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="20%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key Name</th>
<th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">izendaapiprefix</span></code></td>
<td>izapi</td>
<td>This is prefix of your Izenda API service, it is used for distinguish the Izenda API with other api in your application if it exposes more than one service endpoint.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">izendapassphrase</span></code></td>
<td>vqL7SF+9c9FIQEKUOhSZapacQgUQh</td>
<td>The key used for encryption</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">IzendaApiUrl</span></code></td>
<td><a class="reference external" href="http://localhost:14909/izapi/">http://localhost:14909/izapi/</a></td>
<td>Your Izenda API endpoint, used to call the Izenda API in your .NET code</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">izusername</span></code></td>
<td><a class="reference external" href="mailto:IzendaAdmin&#37;&#52;&#48;system&#46;com">IzendaAdmin<span>&#64;</span>system<span>&#46;</span>com</a></td>
<td>Default system level account, in this kit it is used for authentication of specific functions like adding new users, updating the data model, etc. This value must match with the Username in the WebFormsStarterKit.AspNetUsers and IzendaWebForms.IzendaUser tables.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">iztenantname</span></code></td>
<td>[blank]</td>
<td>The tenant of the system level account. This serves the same purpose as the <code class="docutils literal"><span class="pre">izusername</span></code> setting and equates to the &#8220;System&#8221; value in the WebFormsStarterKit.Tenants but does not have a corresponding entry in the IzendaWebForms.IzendaTenant table. The system tenant is implicitly null in Izenda.</td>
</tr>
</tbody>
</table>
<p>In &lt;system.webServer&gt; config node, add below config:</p>
<p>This config includes the http header attribute and api action verb for the Izenda API. It is also used to configure the http handler for the API url convention which will be reserved by the Izenda API Service. Using the config above, all API urls with a prefix of izapi/ will be handled by Izenda. Recall that this handler API prefix must match the value of the <code class="docutils literal"><span class="pre">izendaapiprefix</span></code> setting.</p>
</div>
<div class="section" id="logging-config">
<h3><a class="toc-backref" href="#id44">Logging Config</a><a class="headerlink" href="#logging-config" title="Permalink to this headline">¶</a></h3>
<p>In &lt;configSections&gt; add a new section to configure logging for the Izenda API.</p>
<p>Then add a new log4net node in the config file as well:</p>
</div>
<div class="section" id="configuring-database-connection">
<h3><a class="toc-backref" href="#id45">Configuring Database Connection</a><a class="headerlink" href="#configuring-database-connection" title="Permalink to this headline">¶</a></h3>
<p>Open ~\ WebFormsStarterKit\izendadb.config then update the connection string to your IzendaWebForms DB which was created in the steps above. For example with [MSSQL] SQLServer:</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;ServerTypeId&quot;</span><span class="p">:</span><span class="s2">&quot;572bd576-8c92-4901-ab2a-b16e38144813&quot;</span><span class="p">,</span><span class="nt">&quot;ServerTypeName&quot;</span><span class="p">:</span><span class="s2">&quot;[MSSQL] SQLServer&quot;</span><span class="p">,</span><span class="nt">&quot;ConnectionString&quot;</span><span class="p">:</span><span class="s2">&quot;[your connection string to IzendaMvc]&quot;</span><span class="p">,</span><span class="nt">&quot;ConnectionId&quot;</span><span class="p">:</span><span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">ServerTypeName</span></code> would be one of the following: [MSSQL] SQL Server, [AZSQL] AzureSQL, [MYSQL] MySQL, [ORACL] Oracle, or [PGSQL] PostgreSQL. The ServerTypeId mappings are listed below.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">DatasourceName</th>
<th class="head">Id</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>[AZSQL] AzureSQL</td>
<td>d968e96f-91dc-414d-9fd8-aef2926c9a18</td>
</tr>
<tr class="row-odd"><td>[MYSQL] MySQL</td>
<td>3d4916d1-5a41-4b94-874f-5bedacb89656</td>
</tr>
<tr class="row-even"><td>[ORACL] Oracle</td>
<td>93942448-c715-4f98-85e2-9292ed7ca4bc</td>
</tr>
<tr class="row-odd"><td>[PGSQL] PostgreSQL</td>
<td>f2638ed5-70e5-47da-a052-4da0c1888fcf</td>
</tr>
<tr class="row-even"><td>[MSSQL] SQLServer</td>
<td>572bd576-8c92-4901-ab2a-b16e38144813</td>
</tr>
</tbody>
</table>
<p>Next, open ~\WebFormsStarterkit\Web.config again and modify the DefaultConnection value in the connectionStrings node to configure the Webforms application database link:</p>
</div>
</div>
<div class="section" id="the-first-run-of-izenda-api-service">
<h2><a class="toc-backref" href="#id46">The first run of Izenda API Service</a><a class="headerlink" href="#the-first-run-of-izenda-api-service" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bit-oracle-dll-dependencies">
<h3><a class="toc-backref" href="#id47">64-bit Oracle DLL Dependencies</a><a class="headerlink" href="#bit-oracle-dll-dependencies" title="Permalink to this headline">¶</a></h3>
<p>If you encounter an error related to OracleDataAccesssDTC in Visual Studio, navigate to Tools -&gt; Options -&gt; Projects and Solutions -&gt; Web Projects -&gt; Check &#8220;Use the 64 bit version of IIS Express for web sites and projects&#8221;.</p>
<div class="figure" id="id5">
<a class="reference internal image-reference" href="../_images/mvc_64bit_iis_express.png"><img alt="../_images/mvc_64bit_iis_express.png" src="../_images/mvc_64bit_iis_express.png" style="width: 560px;" /></a>
<p class="caption"><span class="caption-number">Fig. 436 </span><span class="caption-text">64-bit IIS Express</span></p>
</div>
</div>
<div class="section" id="run-starter-kit">
<h3><a class="toc-backref" href="#id48">Run Starter Kit</a><a class="headerlink" href="#run-starter-kit" title="Permalink to this headline">¶</a></h3>
<p>Before you run your starter kit, ensure the Project Url setting in your project settings is set to use the same port that you configured for your <code class="docutils literal"><span class="pre">IzendaApiUrl</span></code> setting in your web.config.</p>
<p>With that minor detail taken care of, you can press F5 in visual studio to run your starter kit for the first time. The application page will look like the screenshot below:</p>
<div class="figure" id="id6">
<a class="reference internal image-reference" href="../_images/webforms_run_starter_kit.png"><img alt="../_images/webforms_run_starter_kit.png" src="../_images/webforms_run_starter_kit.png" style="width: 900px;" /></a>
<p class="caption"><span class="caption-number">Fig. 437 </span><span class="caption-text">Starter kit screen</span></p>
</div>
<p>There is nothing present from the Izenda UI at this time. At this step we are just checking whether Izenda API is able to start up completely or not. On your browser address add /api/ to the end of url (<a class="reference external" href="http://localhost:14809/api/">http://localhost:14809/api/</a>) then press enter, you will see Izenda API is hosted completely:</p>
<div class="figure" id="id7">
<a class="reference internal image-reference" href="../_images/webforms_api_url_404.png"><img alt="../_images/webforms_api_url_404.png" src="../_images/webforms_api_url_404.png" style="width: 900px;" /></a>
<p class="caption"><span class="caption-number">Fig. 438 </span><span class="caption-text">API screen</span></p>
</div>
<p>In the ~\WebFormsStarterkit project folder you will see a logs folder with the log files webforms-kit.log and izenda-log.log (~\WebFormsStarterkit\logs).</p>
</div>
<div class="section" id="izenda-api-hosting-troubleshooting">
<h3><a class="toc-backref" href="#id49">Izenda API Hosting Troubleshooting</a><a class="headerlink" href="#izenda-api-hosting-troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>If you do not see the log files and 404 page above, check the following:</p>
<ul class="simple">
<li>Nancy hosting configuration is correct in the Web.config</li>
<li>Ensure Nancy.dll and Nancy.Hosting.Aspnet.dll are referenced in the project.</li>
<li>Check your routing configuration in RouteConfig.cs</li>
</ul>
</div>
</div>
<div class="section" id="adding-izenda-boundary">
<h2><a class="toc-backref" href="#id50">Adding Izenda Boundary</a><a class="headerlink" href="#adding-izenda-boundary" title="Permalink to this headline">¶</a></h2>
<p>Get all files in the <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/tree/master/WebFormsStarterKit/IzendaBoundary">IzendaBoundary</a> folder from the GitHub repository and include them in your WebFormsStarterkit project. Build the project. If there are any errors regarding missing references, update the references as needed.</p>
<p>The table below describes the functionality of each source code file:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File and Folder</th>
<th class="head">Classes</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Models</td>
<td>Model Entity</td>
<td>Contains the definition of objects used for transferring model data when communicating between your code and the Izenda API.</td>
</tr>
<tr class="row-odd"><td>CustomAdhocReport.cs</td>
<td>CustomAdhocReport</td>
<td>Contains an implementation the IAdHocExtension interface that is used to override many default functions in your Izenda installation. This extension will be automatically located and injected into the runtime by the Izenda API application. More information on this can be found <a class="reference internal" href="ref_iadhocextension.html"><span class="doc">here</span></a></td>
</tr>
<tr class="row-even"><td>IzendaTokenAuthorization.cs</td>
<td>IzendaTokenAuthorization</td>
<td>The helper class used to decrypt and deserialize the authentication token corresponding to the UserInfo object and vice versa (serialize UserInfo object then encrypt to token key. The UserInfo object will be added below).</td>
</tr>
<tr class="row-odd"><td>IzendaUtility.cs</td>
<td>IzendaUtility</td>
<td>The helper class to access specific Izenda REST APIs to get connection, tenant, role, and user info from Izenda.</td>
</tr>
<tr class="row-even"><td>StringCipher.cs</td>
<td>StringCipher</td>
<td>The helper class to encrypt and decrypt the UserInfo and authentication token between each other.</td>
</tr>
<tr class="row-odd"><td>WebAPIService.cs</td>
<td>WebAPIService</td>
<td>The service proxy class that provides the framework for making REST API requests to Izenda using Izenda authentication tokens.</td>
</tr>
</tbody>
</table>
<p>These classes just demonstrate simple examples of using each functionality. It is recommended that in your actual integration you use security best practices that follow your organization&#8217;s established security policies and procedures.</p>
</div>
<div class="section" id="custom-authentication-logic">
<h2><a class="toc-backref" href="#id51">Custom Authentication Logic</a><a class="headerlink" href="#custom-authentication-logic" title="Permalink to this headline">¶</a></h2>
<p>In this starter kit, we use simple authentication with only a username, password and tenant info. Basically, authorization logic (role, permissions …etc.) will depend on the implementation of the Izenda BE.</p>
<p>If you recall, in the WebFormsStarterkit database we added a table named Tenants and a column in the AspNetUsers table named TenantID. Those objects normally don&#8217;t exist in a standard Webforms kit. The TenantID column is a foreign key reference to the Tenants table which demonstrates a one-to-many relationship between Tenant and User. The other tables are kept same as in a webforms template project. This helps us minimize the changes in the login logic, but allows us to show a simple use case for multi-tenant support.</p>
<div class="figure" id="id8">
<a class="reference internal image-reference" href="../_images/mvc_AspNetUsers_Tenants.png"><img alt="../_images/mvc_AspNetUsers_Tenants.png" src="../_images/mvc_AspNetUsers_Tenants.png" style="width: 419px;" /></a>
<p class="caption"><span class="caption-number">Fig. 439 </span><span class="caption-text">Users and Tenants</span></p>
</div>
<p>In integrated mode, authentication is handled by the webforms application, not Izenda. In this starter kit, the Izenda backend will get a token via the <code class="docutils literal"><span class="pre">UserIntegrationConfig.GetAccessToken</span></code> method. You must implement your own code logic to provide this token containing the authenticated user’s information. To ensure security, each request to the Izenda API service will call back to the webforms application to validate the token it received from the originating request. You must provide this validation logic in your app inside the <code class="docutils literal"><span class="pre">UserIntegrationConfig.ValidateToken</span></code> method. The diagram below illustrates the token retrieval and validation process in fully integrated mode:</p>
<div class="figure" id="id9">
<a class="reference internal image-reference" href="../_images/mvc_authentication_sequence_diagram.png"><img alt="../_images/mvc_authentication_sequence_diagram.png" src="../_images/mvc_authentication_sequence_diagram.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 440 </span><span class="caption-text">Authentication Sequence Diagram</span></p>
</div>
<p>To customize the authentication logic, we must modify some existing classes in the ASP.NET webforms application template. The table below lists all the modified classes and pages:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="20%" />
<col width="5%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File</th>
<th class="head">Class</th>
<th class="head">State</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IzendaConfig.cs</td>
<td>IzendaConfig</td>
<td>New</td>
<td>The extension class provides Izenda token and token validation for the Izenda backend.</td>
</tr>
<tr class="row-odd"><td>Models\IdentityModels.cs</td>
<td>ApplicationUser</td>
<td>Modify</td>
<td>The entity class present user identity model. This model maps to AspNetUsers table.</td>
</tr>
<tr class="row-even"><td>Models\IdentityModels.cs</td>
<td>Tenant</td>
<td>New</td>
<td>The entity model presents a tenant, maps to Tenants table.</td>
</tr>
<tr class="row-odd"><td>Models\IdentityModels.cs</td>
<td>ApplicationDBContext</td>
<td>Modify</td>
<td>Entity Framework DB context.</td>
</tr>
<tr class="row-even"><td>App_Start\IdentityConfig.cs</td>
<td>ApplicationUserManager</td>
<td>Modify</td>
<td>Manage authentication user and login context.</td>
</tr>
<tr class="row-odd"><td>App_Start\IdentityConfig.cs</td>
<td>ApplicationSignInManager</td>
<td>Modify</td>
<td>Custom sign in logic.</td>
</tr>
<tr class="row-even"><td>App_Start\WebApiConfig.cs</td>
<td>WebApiConfig</td>
<td>Add</td>
<td>Required to handle a specific callback to the GenerateToken route</td>
</tr>
<tr class="row-odd"><td>Account\Login.aspx</td>
<td>[N/A]</td>
<td>Modify</td>
<td>Include the tenant in the page.</td>
</tr>
<tr class="row-even"><td>Account\Login.aspx.cs</td>
<td>Login</td>
<td>Modify</td>
<td>Update login logic to use the customizations.</td>
</tr>
<tr class="row-odd"><td>ApiControllers\UserController.cs</td>
<td>UserController</td>
<td>Add</td>
<td>Required for handling the GenerateToken route.</td>
</tr>
<tr class="row-even"><td>Global.asax.cs</td>
<td>Global</td>
<td>Modify</td>
<td>Implement the route mapping from the WebAPIConfig</td>
</tr>
</tbody>
</table>
<div class="section" id="izendaconfig">
<h3><a class="toc-backref" href="#id52">IzendaConfig</a><a class="headerlink" href="#izendaconfig" title="Permalink to this headline">¶</a></h3>
<p>Create IzendaConfig.cs file within the top level of the project and implement subscription for <code class="docutils literal"><span class="pre">UserIntegrationConfig.GetAccessToken</span></code> action and <code class="docutils literal"><span class="pre">UserIntegrationConfig.ValidateToken</span></code> action.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">public</span> <span class="n">static</span> <span class="k">class</span> <span class="nc">IzendaConfig</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">static</span> <span class="n">void</span> <span class="n">RegisterLoginLogic</span><span class="p">()</span>
        <span class="p">{</span>
<span class="hll">            <span class="n">UserIntegrationConfig</span><span class="o">.</span><span class="n">GetAccessToken</span> <span class="o">=</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">=&gt;</span>
</span>            <span class="p">{</span>
                <span class="k">return</span> <span class="n">IzendaBoundary</span><span class="o">.</span><span class="n">IzendaTokenAuthorization</span><span class="o">.</span><span class="n">GetToken</span><span class="p">(</span><span class="n">new</span> <span class="n">Models</span><span class="o">.</span><span class="n">UserInfo</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">UserName</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">UserName</span><span class="p">,</span>
                    <span class="n">TenantUniqueName</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">TenantId</span>
                <span class="p">});</span>
            <span class="p">};</span>

<span class="hll">            <span class="n">UserIntegrationConfig</span><span class="o">.</span><span class="n">ValidateToken</span> <span class="o">=</span> <span class="p">(</span><span class="n">ValidateTokenArgs</span> <span class="n">args</span><span class="p">)</span> <span class="o">=&gt;</span>
</span>            <span class="p">{</span>
                <span class="n">var</span> <span class="n">token</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">AccessToken</span><span class="p">;</span>
                <span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="n">IzendaBoundary</span><span class="o">.</span><span class="n">IzendaTokenAuthorization</span><span class="o">.</span><span class="n">GetUserInfo</span><span class="p">(</span><span class="n">token</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">new</span> <span class="n">ValidateTokenResult</span> <span class="p">{</span> <span class="n">UserName</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">UserName</span><span class="p">,</span> <span class="n">TenantUniqueName</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">TenantUniqueName</span> <span class="p">};</span>
            <span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Action <code class="docutils literal"><span class="pre">UserIntegrationConfig.GetAccessToken</span></code> will convert user info to a token value.</p>
<p>Action <code class="docutils literal"><span class="pre">UserIntegrationConfig.ValidateToken</span></code> convert access token to user info.</p>
</div>
<div class="section" id="identity-models-namespaces">
<h3><a class="toc-backref" href="#id53">Identity Models – Namespaces</a><a class="headerlink" href="#identity-models-namespaces" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open Models\IdentityModels.cs.</li>
<li>Add the following namespaces so that it appears as below:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Security</span><span class="o">.</span><span class="n">Claims</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Threading</span><span class="o">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">EntityFramework</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">ComponentModel</span><span class="o">.</span><span class="n">DataAnnotations</span><span class="o">.</span><span class="n">Schema</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Linq</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="identity-models-applicationuser-class">
<h3><a class="toc-backref" href="#id54">Identity Models – ApplicationUser class</a><a class="headerlink" href="#identity-models-applicationuser-class" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Next in Models\IdentityModels.cs.</li>
<li>Add Tenant_Id property and custom claim identity like below:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>    // You can add User data for the user by adding more properties to your User class, please visit http://go.microsoft.com/fwlink/?LinkID=317594 to learn more.
    public class ApplicationUser : IdentityUser
<span class="hll">    {
</span><span class="hll">        public int Tenant_Id { get; set; }
</span><span class="hll">        [ForeignKey(&quot;Tenant_Id&quot;)]
</span>        public Tenant Tenant { get; set; }
        public async Task&lt;ClaimsIdentity&gt; GenerateUserIdentityAsync(UserManager&lt;ApplicationUser&gt; manager)
        {
<span class="hll">            // Note the authenticationType must match the one defined in CookieAuthenticationOptions.AuthenticationType
</span><span class="hll">            var userIdentity = await manager.CreateIdentityAsync(this, DefaultAuthenticationTypes.ApplicationCookie);
</span><span class="hll">
</span><span class="hll">            if (Tenant != null)
</span><span class="hll">            {
</span><span class="hll">                userIdentity.AddClaims(new[] {
</span><span class="hll">                    new Claim(&quot;tenantName&quot;,Tenant.Name),
</span><span class="hll">                    new Claim(&quot;tenantId&quot;,Tenant.Id.ToString()),
</span><span class="hll">                });
</span><span class="hll">            }
</span><span class="hll">            var role = (await manager.GetRolesAsync(this.Id)).FirstOrDefault();
</span><span class="hll">            userIdentity.AddClaim(new Claim(ClaimsIdentity.DefaultRoleClaimType, role));
</span><span class="hll">
</span><span class="hll">            // Add custom user claims here
</span><span class="hll">            return userIdentity;
</span><span class="hll">        }
</span></pre></div>
</div>
<p>The ApplicationUser class represents the user model and maps to the AspNetUsers table. The Tenant_Id property is the foreign key reference to the tenant of the user. In the GenerateUserIdentityAsync method, we are adding the tenantId into the user identity. This value will be used to establish “claims” based on the user’s tenant.</p>
</div>
<div class="section" id="identity-models-tenant">
<h3><a class="toc-backref" href="#id55">Identity Models – Tenant</a><a class="headerlink" href="#identity-models-tenant" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Next in Models\IdentityModels.cs.</li>
<li>Add a new Tenant class to represent a tenant object. This class is an entity model that maps to the Tenants table. The example below utilizes a very simple tenant model. You can customize this model to store more complex information.</li>
</ol>
<div class="highlight-default"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
    <span class="n">public</span> <span class="k">class</span> <span class="nc">Tenant</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="nb">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="identity-models-applicationdbcontext">
<h3><a class="toc-backref" href="#id56">Identity Models – ApplicationDBContext</a><a class="headerlink" href="#identity-models-applicationdbcontext" title="Permalink to this headline">¶</a></h3>
<p>This is the Entity Framework DB context of the entire authentication database. Because we added a new Tenants table, we must update the DB context to include our new model and link it to the entity.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">public</span> <span class="k">class</span> <span class="nc">ApplicationDbContext</span> <span class="p">:</span> <span class="n">IdentityDbContext</span><span class="o">&lt;</span><span class="n">ApplicationUser</span><span class="o">&gt;</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">ApplicationDbContext</span><span class="p">()</span>
            <span class="p">:</span> <span class="n">base</span><span class="p">(</span><span class="s2">&quot;DefaultConnection&quot;</span><span class="p">,</span> <span class="n">throwIfV1Schema</span><span class="p">:</span> <span class="n">false</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

<span class="hll">        <span class="n">public</span> <span class="n">static</span> <span class="n">ApplicationDbContext</span> <span class="n">Create</span><span class="p">()</span>
</span>        <span class="p">{</span>
            <span class="k">return</span> <span class="n">new</span> <span class="n">ApplicationDbContext</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If your starter kit contains another ApplicationDBContext definition, you may need to remove the duplicate to prevent errors.</p>
</div>
<div class="section" id="identity-config-namespaces">
<h3><a class="toc-backref" href="#id57">Identity Config – Namespaces</a><a class="headerlink" href="#identity-config-namespaces" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open App_Start\IdentityConfig.cs.</li>
<li>Add the following namespaces so that it appears as below:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="hll"><span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">Entity</span><span class="p">;</span>
</span><span class="hll"><span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Linq</span><span class="p">;</span>
</span><span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Security</span><span class="o">.</span><span class="n">Claims</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Threading</span><span class="o">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">EntityFramework</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">Owin</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Owin</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">Owin</span><span class="o">.</span><span class="n">Security</span><span class="p">;</span>
<span class="n">using</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Models</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="identity-config-applicationusermanager">
<h3><a class="toc-backref" href="#id58">Identity Config – ApplicationUserManager</a><a class="headerlink" href="#identity-config-applicationusermanager" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Next in App_Start\IdentityConfig.cs.</li>
<li>Add a new method to the ApplicationUserManager class called FindTenantUserAsync. This will be used to query and retrieve users by tenant, username, and password.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>        <span class="n">public</span> <span class="k">async</span> <span class="n">Task</span><span class="o">&lt;</span><span class="n">ApplicationUser</span><span class="o">&gt;</span> <span class="n">FindTenantUserAsync</span><span class="p">(</span><span class="n">string</span> <span class="n">tenant</span><span class="p">,</span> <span class="n">string</span> <span class="n">username</span><span class="p">,</span> <span class="n">string</span> <span class="n">password</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">var</span> <span class="n">context</span> <span class="o">=</span> <span class="n">ApplicationDbContext</span><span class="o">.</span><span class="n">Create</span><span class="p">();</span>

            <span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">Users</span>
                <span class="o">.</span><span class="n">Include</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Tenant</span><span class="p">)</span>
                <span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">UserName</span><span class="o">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">StringComparison</span><span class="o">.</span><span class="n">InvariantCultureIgnoreCase</span><span class="p">))</span>
                <span class="o">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Tenant</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">tenant</span><span class="p">,</span> <span class="n">StringComparison</span><span class="o">.</span><span class="n">InvariantCultureIgnoreCase</span><span class="p">))</span>
                <span class="o">.</span><span class="n">SingleOrDefaultAsync</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span><span class="k">await</span> <span class="n">CheckPasswordAsync</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">user</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="identity-configs-applicationsigninmanager">
<h3><a class="toc-backref" href="#id59">Identity Configs – ApplicationSignInManager</a><a class="headerlink" href="#identity-configs-applicationsigninmanager" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Next in App_Start\IdentityConfig.cs.</li>
<li>Add a new method PasswordSigninAsync to customize sign in logic. This method utilizes the FindTenantUserAsync method added above to find a user with the specified username, password and tenant.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">public</span> <span class="k">class</span> <span class="nc">ApplicationSignInManager</span> <span class="p">:</span> <span class="n">SignInManager</span><span class="o">&lt;</span><span class="n">ApplicationUser</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">ApplicationSignInManager</span><span class="p">(</span><span class="n">ApplicationUserManager</span> <span class="n">userManager</span><span class="p">,</span> <span class="n">IAuthenticationManager</span> <span class="n">authenticationManager</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">base</span><span class="p">(</span><span class="n">userManager</span><span class="p">,</span> <span class="n">authenticationManager</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

<span class="hll">        <span class="n">public</span> <span class="k">async</span> <span class="n">Task</span><span class="o">&lt;</span><span class="nb">bool</span><span class="o">&gt;</span> <span class="n">PasswordSignInAsync</span><span class="p">(</span><span class="n">string</span> <span class="n">tenant</span><span class="p">,</span> <span class="n">string</span> <span class="n">username</span><span class="p">,</span> <span class="n">string</span> <span class="n">password</span><span class="p">,</span> <span class="nb">bool</span> <span class="n">remember</span><span class="p">)</span>
</span><span class="hll">        <span class="p">{</span>
</span><span class="hll">            <span class="n">var</span> <span class="n">appUserManager</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">UserManager</span> <span class="k">as</span> <span class="n">ApplicationUserManager</span><span class="p">;</span>
</span><span class="hll">            <span class="k">if</span> <span class="p">(</span><span class="n">appUserManager</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
</span><span class="hll">            <span class="p">{</span>
</span><span class="hll">                <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">
</span><span class="hll">            <span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">appUserManager</span><span class="o">.</span><span class="n">FindTenantUserAsync</span><span class="p">(</span><span class="n">tenant</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
</span><span class="hll">            <span class="k">if</span> <span class="p">(</span><span class="n">user</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
</span><span class="hll">            <span class="p">{</span>
</span><span class="hll">                <span class="k">await</span> <span class="n">SignInAsync</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">remember</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
</span><span class="hll">                <span class="k">return</span> <span class="n">true</span><span class="p">;</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">            
</span><span class="hll">            <span class="k">return</span> <span class="n">false</span><span class="p">;</span>
</span><span class="hll">        <span class="p">}</span>
</span></pre></div>
</div>
</div>
<div class="section" id="app-start-webapiconfig">
<h3><a class="toc-backref" href="#id60">App_Start - WebApiConfig</a><a class="headerlink" href="#app-start-webapiconfig" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Create App_Start\WebAPIConfig.cs</li>
<li>Add the following:</li>
</ol>
</div>
<div class="section" id="login-aspx-cs-namespace">
<h3><a class="toc-backref" href="#id61">Login.aspx.cs - Namespace</a><a class="headerlink" href="#login-aspx-cs-namespace" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open Acount\Login.aspx.cs</li>
<li>Add the following namespaces so that it appears as below:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Globalization</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Linq</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Security</span><span class="o">.</span><span class="n">Claims</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Threading</span><span class="o">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">UI</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">Owin</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Owin</span><span class="p">;</span>
<span class="n">using</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Models</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="login-aspx-cs">
<h3><a class="toc-backref" href="#id62">Login.aspx.cs</a><a class="headerlink" href="#login-aspx-cs" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Next in Acount\Login.aspx.cs</li>
<li>In Login method, implement the ApplicationSignInMangager/PasswordSigninAsync method as shown below.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>        <span class="n">protected</span> <span class="k">async</span> <span class="n">void</span> <span class="n">LogIn</span><span class="p">(</span><span class="nb">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">IsValid</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="o">//</span> <span class="n">Validate</span> <span class="n">the</span> <span class="n">user</span> <span class="n">password</span>
<span class="hll">                <span class="n">var</span> <span class="n">signinManager</span> <span class="o">=</span> <span class="n">Context</span><span class="o">.</span><span class="n">GetOwinContext</span><span class="p">()</span><span class="o">.</span><span class="n">GetUserManager</span><span class="o">&lt;</span><span class="n">ApplicationSignInManager</span><span class="o">&gt;</span><span class="p">();</span>
</span><span class="hll">
</span><span class="hll">                <span class="o">//</span> <span class="n">This</span> <span class="n">doen</span><span class="s1">&#39;t count login failures towards account lockout</span>
</span><span class="hll">                <span class="o">//</span> <span class="n">To</span> <span class="n">enable</span> <span class="n">password</span> <span class="n">failures</span> <span class="n">to</span> <span class="n">trigger</span> <span class="n">lockout</span><span class="p">,</span> <span class="n">change</span> <span class="n">to</span> <span class="n">shouldLockout</span><span class="p">:</span> <span class="n">true</span>
</span><span class="hll">                <span class="n">var</span> <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">signinManager</span><span class="o">.</span><span class="n">PasswordSignInAsync</span><span class="p">(</span><span class="n">Tenant</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">Email</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">Password</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">RememberMe</span><span class="o">.</span><span class="n">Checked</span><span class="p">);</span>
</span><span class="hll">
</span><span class="hll">                <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span class="hll">                    <span class="n">IdentityHelper</span><span class="o">.</span><span class="n">RedirectToReturnUrl</span><span class="p">(</span><span class="n">Request</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;ReturnUrl&quot;</span><span class="p">],</span> <span class="n">Response</span><span class="p">);</span>
</span><span class="hll">                <span class="k">else</span>
</span><span class="hll">                <span class="p">{</span>
</span><span class="hll">                    <span class="n">FailureText</span><span class="o">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s2">&quot;Invalid login attempt&quot;</span><span class="p">;</span>
</span><span class="hll">                    <span class="n">ErrorMessage</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span>                <span class="p">}</span>
                <span class="o">//</span><span class="n">var</span> <span class="n">result</span> <span class="o">=</span> <span class="n">signinManager</span><span class="o">.</span><span class="n">PasswordSignIn</span><span class="p">(</span><span class="n">Email</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">Password</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">RememberMe</span><span class="o">.</span><span class="n">Checked</span><span class="p">,</span> <span class="n">shouldLockout</span><span class="p">:</span> <span class="n">false</span><span class="p">);</span>
                <span class="o">//</span><span class="n">switch</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="o">//</span><span class="p">{</span>
                <span class="o">//</span>    <span class="n">case</span> <span class="n">SignInStatus</span><span class="o">.</span><span class="n">Success</span><span class="p">:</span>
                <span class="o">//</span>        <span class="n">IdentityHelper</span><span class="o">.</span><span class="n">RedirectToReturnUrl</span><span class="p">(</span><span class="n">Request</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;ReturnUrl&quot;</span><span class="p">],</span> <span class="n">Response</span><span class="p">);</span>
                <span class="o">//</span>        <span class="k">break</span><span class="p">;</span>
                <span class="o">//</span>    <span class="n">case</span> <span class="n">SignInStatus</span><span class="o">.</span><span class="n">LockedOut</span><span class="p">:</span>
                <span class="o">//</span>        <span class="n">Response</span><span class="o">.</span><span class="n">Redirect</span><span class="p">(</span><span class="s2">&quot;/Account/Lockout&quot;</span><span class="p">);</span>
                <span class="o">//</span>        <span class="k">break</span><span class="p">;</span>
                <span class="o">//</span>    <span class="n">case</span> <span class="n">SignInStatus</span><span class="o">.</span><span class="n">RequiresVerification</span><span class="p">:</span>
                <span class="o">//</span>        <span class="n">Response</span><span class="o">.</span><span class="n">Redirect</span><span class="p">(</span><span class="n">String</span><span class="o">.</span><span class="n">Format</span><span class="p">(</span><span class="s2">&quot;/Account/TwoFactorAuthenticationSignIn?ReturnUrl=</span><span class="si">{0}</span><span class="s2">&amp;RememberMe=</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="o">//</span>                                        <span class="n">Request</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;ReturnUrl&quot;</span><span class="p">],</span>
                <span class="o">//</span>                                        <span class="n">RememberMe</span><span class="o">.</span><span class="n">Checked</span><span class="p">),</span>
                <span class="o">//</span>                          <span class="n">true</span><span class="p">);</span>
                <span class="o">//</span>        <span class="k">break</span><span class="p">;</span>
                <span class="o">//</span>    <span class="n">case</span> <span class="n">SignInStatus</span><span class="o">.</span><span class="n">Failure</span><span class="p">:</span>
                <span class="o">//</span>    <span class="n">default</span><span class="p">:</span>
                <span class="o">//</span>        <span class="n">FailureText</span><span class="o">.</span><span class="n">Text</span> <span class="o">=</span> <span class="s2">&quot;Invalid login attempt&quot;</span><span class="p">;</span>
                <span class="o">//</span>        <span class="n">ErrorMessage</span><span class="o">.</span><span class="n">Visible</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
                <span class="o">//</span>        <span class="k">break</span><span class="p">;</span>
                <span class="o">//</span><span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="userinfo">
<h3><a class="toc-backref" href="#id63">UserInfo</a><a class="headerlink" href="#userinfo" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Create Models\UserInfo.cs</li>
<li>Add the following:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Models</span>
<span class="p">{</span>
    <span class="n">public</span> <span class="k">class</span> <span class="nc">UserInfo</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">UserName</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">TenantUniqueName</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="update-login-page">
<h3><a class="toc-backref" href="#id64">Update Login Page</a><a class="headerlink" href="#update-login-page" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open Account\Login.aspx</li>
<li>Replace the contents of this file with the following from the <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Account/Login.aspx">GitHub WebFormsStarterKit equivalent</a>. This will add a Tenant section to the login page.</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>                    <span class="o">&lt;</span><span class="n">h4</span><span class="o">&gt;</span><span class="n">Use</span> <span class="n">a</span> <span class="n">local</span> <span class="n">account</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span><span class="o">.&lt;/</span><span class="n">h4</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="n">hr</span> <span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">PlaceHolder</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;ErrorMessage&quot;</span> <span class="n">Visible</span><span class="o">=</span><span class="s2">&quot;false&quot;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="n">p</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;text-danger&quot;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Literal</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;FailureText&quot;</span> <span class="o">/&gt;</span>
                        <span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
                    <span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">PlaceHolder</span><span class="o">&gt;</span>
<span class="hll">                    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;form-group&quot;</span><span class="o">&gt;</span>
</span><span class="hll">                        <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">AssociatedControlID</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;col-md-2 control-label&quot;</span><span class="o">&gt;</span><span class="n">Tenant</span><span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span><span class="o">&gt;</span>
</span><span class="hll">                        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;col-md-10&quot;</span><span class="o">&gt;</span>
</span><span class="hll">                            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">TextBox</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span> <span class="o">/&gt;</span>
</span><span class="hll">                            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">RequiredFieldValidator</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ControlToValidate</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span>
</span><span class="hll">                                <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;text-danger&quot;</span> <span class="n">ErrorMessage</span><span class="o">=</span><span class="s2">&quot;The tenant field is required&quot;</span> <span class="o">/&gt;</span>
</span><span class="hll">                        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class="hll">                    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span>                    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;form-group&quot;</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">AssociatedControlID</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;col-md-2 control-label&quot;</span><span class="o">&gt;</span><span class="n">Email</span><span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;col-md-10&quot;</span><span class="o">&gt;</span>
                            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">TextBox</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span> <span class="n">TextMode</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span> <span class="o">/&gt;</span>
                            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">RequiredFieldValidator</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ControlToValidate</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span>
                                <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;text-danger&quot;</span> <span class="n">ErrorMessage</span><span class="o">=</span><span class="s2">&quot;The email field is required.&quot;</span> <span class="o">/&gt;</span>
                        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
                    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="apicontrollers-usercontroller">
<h3><a class="toc-backref" href="#id65">ApiControllers - UserController</a><a class="headerlink" href="#apicontrollers-usercontroller" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Create ApiControllers\UserController.cs</li>
<li>Add the following:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">Http</span><span class="p">;</span>
<span class="n">using</span> <span class="n">Microsoft</span><span class="o">.</span><span class="n">AspNet</span><span class="o">.</span><span class="n">Identity</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">ApiControllers</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">Authorize</span><span class="p">]</span>
    <span class="p">[</span><span class="n">RoutePrefix</span><span class="p">(</span><span class="s2">&quot;api/user&quot;</span><span class="p">)]</span>
    <span class="n">public</span> <span class="k">class</span> <span class="nc">UserController</span> <span class="p">:</span> <span class="n">ApiController</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">Authorize</span><span class="p">]</span>
        <span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
        <span class="p">[</span><span class="n">Route</span><span class="p">(</span><span class="s2">&quot;GenerateToken&quot;</span><span class="p">)]</span>
        <span class="n">public</span> <span class="n">string</span> <span class="n">GenerateToken</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">var</span> <span class="n">username</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">Identity</span><span class="o">.</span><span class="n">GetUserName</span><span class="p">();</span>
            <span class="n">var</span> <span class="n">tenantName</span> <span class="o">=</span> <span class="p">((</span><span class="n">System</span><span class="o">.</span><span class="n">Security</span><span class="o">.</span><span class="n">Claims</span><span class="o">.</span><span class="n">ClaimsIdentity</span><span class="p">)</span><span class="n">User</span><span class="o">.</span><span class="n">Identity</span><span class="p">)</span><span class="o">.</span><span class="n">FindFirstValue</span><span class="p">(</span><span class="s2">&quot;tenantName&quot;</span><span class="p">);</span>

            <span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Models</span><span class="o">.</span><span class="n">UserInfo</span> <span class="p">{</span> <span class="n">UserName</span> <span class="o">=</span> <span class="n">username</span><span class="p">,</span> <span class="n">TenantUniqueName</span> <span class="o">=</span> <span class="n">tenantName</span> <span class="p">};</span>
            <span class="n">var</span> <span class="n">token</span> <span class="o">=</span> <span class="n">IzendaBoundary</span><span class="o">.</span><span class="n">IzendaTokenAuthorization</span><span class="o">.</span><span class="n">GetToken</span><span class="p">(</span><span class="n">user</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">token</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="global-asax-cs">
<h3><a class="toc-backref" href="#id66">global.asax.cs</a><a class="headerlink" href="#global-asax-cs" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Open global.asax.cs</li>
<li>Add the following code:</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="n">public</span> <span class="k">class</span> <span class="nc">Global</span> <span class="p">:</span> <span class="n">HttpApplication</span>
    <span class="p">{</span>
        <span class="n">void</span> <span class="n">Application_Start</span><span class="p">(</span><span class="nb">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="o">//</span> <span class="n">Code</span> <span class="n">that</span> <span class="n">runs</span> <span class="n">on</span> <span class="n">application</span> <span class="n">startup</span>
<span class="hll">            <span class="n">GlobalConfiguration</span><span class="o">.</span><span class="n">Configure</span><span class="p">(</span><span class="n">WebApiConfig</span><span class="o">.</span><span class="n">Register</span><span class="p">);</span>
</span>            <span class="n">RouteConfig</span><span class="o">.</span><span class="n">RegisterRoutes</span><span class="p">(</span><span class="n">RouteTable</span><span class="o">.</span><span class="n">Routes</span><span class="p">);</span>
            <span class="n">BundleConfig</span><span class="o">.</span><span class="n">RegisterBundles</span><span class="p">(</span><span class="n">BundleTable</span><span class="o">.</span><span class="n">Bundles</span><span class="p">);</span>
<span class="hll">			<span class="n">IzendaConfig</span><span class="o">.</span><span class="n">RegisterLoginLogic</span><span class="p">();</span>
</span>        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-first-login">
<h2><a class="toc-backref" href="#id67">Run First Login</a><a class="headerlink" href="#run-first-login" title="Permalink to this headline">¶</a></h2>
<p>Press F5 to run application, navigate to login page and enter the values below for the respective fields:</p>
<ul class="simple">
<li>Tenant = System</li>
<li>Email = <a class="reference external" href="mailto:IzendaAdmin&#37;&#52;&#48;system&#46;com">IzendaAdmin<span>&#64;</span>system<span>&#46;</span>com</a></li>
<li>Password = <a class="reference external" href="mailto:Izenda&#37;&#52;&#48;123">Izenda<span>&#64;</span>123</a></li>
</ul>
<p>Then click Login. You will see the home page with the logged in user’s email on top right of the page.</p>
<div class="figure" id="id10">
<a class="reference internal image-reference" href="../_images/webforms_current_user_ui.png"><img alt="../_images/webforms_current_user_ui.png" src="../_images/webforms_current_user_ui.png" style="width: 730px;" /></a>
<p class="caption"><span class="caption-number">Fig. 441 </span><span class="caption-text">Current user and Log off button</span></p>
</div>
</div>
<div class="section" id="update-shared-layout">
<h2><a class="toc-backref" href="#id68">Update Shared Layout</a><a class="headerlink" href="#update-shared-layout" title="Permalink to this headline">¶</a></h2>
<div class="section" id="construct-izenda-menu-items">
<h3><a class="toc-backref" href="#id69">Construct Izenda Menu Items</a><a class="headerlink" href="#construct-izenda-menu-items" title="Permalink to this headline">¶</a></h3>
<p>Open ~\Site.master then add menu items for Izenda pages:</p>
<p>Note that the menu redirects require the creation of several new pages. These will be created in a later section.</p>
<p>Important! The webforms starter project will include the main placeholder for body content inside a form tag. This will cause some Izenda buttons to improperly issue a &#8216;submit&#8217; event. To fix this, place the following code</p>
<p>In addition, another change is required to allow the Login page to continue working. Notice that in the above sample, we have added another placeholder inside the form tag with the ID &#8220;LoginContent&#8221;. We will need to change the placeholder reference in Login.aspx to match.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;%@</span> <span class="n">Register</span> <span class="n">Src</span><span class="o">=</span><span class="s2">&quot;~/Account/OpenAuthProviders.ascx&quot;</span> <span class="n">TagPrefix</span><span class="o">=</span><span class="s2">&quot;uc&quot;</span> <span class="n">TagName</span><span class="o">=</span><span class="s2">&quot;OpenAuthProviders&quot;</span> <span class="o">%&gt;</span>

<span class="hll"><span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Content</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;LoginContent&quot;</span> <span class="n">ContentPlaceHolderID</span><span class="o">=</span><span class="s2">&quot;MainContent&quot;</span><span class="o">&gt;</span>
</span>    <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;&lt;%</span><span class="p">:</span> <span class="n">Title</span> <span class="o">%&gt;.&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>

    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Optional: Izenda uses a class called &#8220;container&#8221; with some CSS to scale Izenda&#8217;s components to fit the container&#8217;s size. The webforms sample project uses the container class to limit the available display area of contents. To expand the available space, you can perform the following actions:</p>
<p>Remove the container class completely from the nav bar</p>
<p>Change the container class to &#8220;izenda-container&#8221; in the body-content div</p>
<p>Add the following css to the Site.css file</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">izenda-container</span> <span class="p">{</span>
   <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
   <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
   <span class="k">min-height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="implement-izenda-configuration-initialization">
<h3><a class="toc-backref" href="#id70">Implement Izenda Configuration Initialization</a><a class="headerlink" href="#implement-izenda-configuration-initialization" title="Permalink to this headline">¶</a></h3>
<p>Add Javascript code below into the bottom of the Site.Master to initialize the Izenda Configuration and sub menu dropdown display. The function DoIzendaConfig() is located in ~\Scripts\izenda.integrate.js. It initializes the main config values needed to run Izenda’s integrated UI such as the API Service Url, the path of the Izenda embedded JavaScript package, custom CSS styling, Izenda UI routing config, and the request timeout.</p>
</div>
</div>
<div class="section" id="embedding-front-end-izenda-izenda-ui">
<h2><a class="toc-backref" href="#id71">Embedding Front-end Izenda (Izenda UI)</a><a class="headerlink" href="#embedding-front-end-izenda-izenda-ui" title="Permalink to this headline">¶</a></h2>
<div class="section" id="embedding-izenda-full-page">
<h3><a class="toc-backref" href="#id72">Embedding Izenda full page</a><a class="headerlink" href="#embedding-izenda-full-page" title="Permalink to this headline">¶</a></h3>
<p>Create ~\Izenda.aspx</p>
<p>This page is used to embedded the entire Izenda application into one view.</p>
<p>In this page, we will call the function izendaInit() defined in ~\Scripts\izenda.integrate.js. The full Izenda UI will be rendered when opening this page, including the ReportViewer, ReportDesigner, Dashboard, and Setting pages. Navigation will be fully contained within the single page.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;Izenda&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Izenda.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.IzendaRoot&quot; %&gt;

&lt;asp:Content ID=&quot;IzendaContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
            izendaInit();
        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
<p>We have 2 empty div elements for each Izenda page. The <code class="docutils literal"><span class="pre">loader</span></code> div is used for displaying the progress bar when the page is waiting for a response from the Izenda back-end. The div <code class="docutils literal"><span class="pre">izenda-container</span></code> is the container for Izenda page content.</p>
</div>
<div class="section" id="embedding-specific-izenda-pages">
<h3><a class="toc-backref" href="#id73">Embedding Specific Izenda Pages</a><a class="headerlink" href="#embedding-specific-izenda-pages" title="Permalink to this headline">¶</a></h3>
<div class="section" id="embedding-the-izenda-settings-page">
<h4><a class="toc-backref" href="#id74">Embedding the Izenda Settings Page</a><a class="headerlink" href="#embedding-the-izenda-settings-page" title="Permalink to this headline">¶</a></h4>
<p>Create ~\Settings.aspx</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Settings.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Settings&quot; %&gt;

&lt;asp:Content ID=&quot;SettingsContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
            izendaInitSetting();
        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
<p>The struture here is very similar to the Izenda.aspx page, as it contains the same elements, but this will specifically embed the Settings page into the page.</p>
</div>
<div class="section" id="embedding-the-izenda-report-list-page">
<h4><a class="toc-backref" href="#id75">Embedding the Izenda Report List Page</a><a class="headerlink" href="#embedding-the-izenda-report-list-page" title="Permalink to this headline">¶</a></h4>
<p>Create ~\Report\Reports.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;Report List&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Reports.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Report.Reports&quot; %&gt;
&lt;asp:Content ID=&quot;ReportsContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
            izendaInitReport();
        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
<p>Continue following the pattern of calling the appropriate javascript function in izenda.integrate.js.</p>
</div>
<div class="section" id="embedding-the-izenda-report-designer-page">
<h4><a class="toc-backref" href="#id76">Embedding the Izenda Report Designer Page</a><a class="headerlink" href="#embedding-the-izenda-report-designer-page" title="Permalink to this headline">¶</a></h4>
<p>Create ~\Report\ReportDesigner.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;New Report&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;ReportDesigner.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Report.ReportDesigner&quot; %&gt;

&lt;asp:Content ID=&quot;ReportDesignerContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
            izendaInitReportDesigner();
        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
</div>
<div class="section" id="report-part-for-exporting">
<h4><a class="toc-backref" href="#id77">Report Part for Exporting</a><a class="headerlink" href="#report-part-for-exporting" title="Permalink to this headline">¶</a></h4>
<p>This page is not displayed directly to the end-users. It is used for rendering report parts (charts, gauges, and maps) for exporting. Reports containing these report part types must be rendered to capture html content then converted to an image when creating exports (pdf, word, excel, etc.).</p>
<p>This page is requested by the Izenda backend over the route url <code class="docutils literal"><span class="pre">viewer/reportpart/{id}</span></code> and mapped to <code class="docutils literal"><span class="pre">report/reportpart.aspx</span></code> in route config ~\App_Start\RouteConfig.cs.</p>
<p>Create ~\Report\ReportPart.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;ReportPart.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Report.ReportPart&quot; %&gt;

&lt;!DOCTYPE html&gt;

&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;
&lt;head runat=&quot;server&quot;&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;/&gt;
    &lt;title&gt;Report Viewer&lt;/title&gt;

    &lt;webopt:BundleReference runat=&quot;server&quot; Path=&quot;~/Content/css&quot; /&gt;
    &lt;link href=&quot;~/favicon.ico&quot; rel=&quot;shortcut icon&quot; type=&quot;image/x-icon&quot; /&gt;

    &lt;%: Scripts.Render(&quot;~/bundles/modernizr&quot;) %&gt;
    
    &lt;%--Apply css--%&gt;
    &lt;link href=&quot;~/Scripts/izenda/izenda-ui.css&quot; rel=&quot;stylesheet&quot;/&gt;

&lt;/head&gt;
&lt;body&gt;
    &lt;%: Scripts.Render(&quot;~/bundles/jquery&quot;) %&gt;
    &lt;%: Scripts.Render(&quot;~/bundles/bootstrap&quot;) %&gt;
    &lt;%: Scripts.Render(&quot;~/bundles/izenda&quot;) %&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
            DoIzendaConfig();
            $(&#39;[data-toggle=&quot;tooltip&quot;]&#39;).tooltip();
            $(&#39;[data-toggle=&quot;dropdown&quot;]&#39;).dropdown();
            $(&quot;#reportPartLoader&quot;).hide();
            $(&quot;#reportPartLoaderText&quot;).hide();

<span class="hll">            izendaInitReportPartExportViewer(&#39;&lt;%=ReportId%&gt;&#39;, &#39;&lt;%=Token%&gt;&#39;);
</span>            // $(&#39;#izenda-root&#39;).children().first().removeClass(&#39;izenda&#39;);
            //var classList = $(&#39;#izenda-root&#39;).children().first().attr(&#39;class&#39;).split(/\s+/);
            //$.each(classList, function (index, item) {
            //    console.log(item);
            //});
        });
    &lt;/script&gt;

    &lt;style&gt;
        #izenda-root &gt; .izenda {
            background-color: transparent !important;
        }
    &lt;/style&gt;

    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot; style=&quot;margin-top: 0px;&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>This page is only used by Izenda backend, so it requires a minimal view containing only the report part content. Therefore, it will not require a master page. The call to <code class="docutils literal"><span class="pre">izendaInitReportPartExportViewer</span></code> is the pivotal portion of this file and it requires an additional piece to work.</p>
<p>Open ReportPart.aspx.cs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">UI</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Report</span>
<span class="p">{</span>
    <span class="n">public</span> <span class="n">partial</span> <span class="k">class</span> <span class="nc">ReportPart</span> <span class="p">:</span> <span class="n">Page</span>
    <span class="p">{</span>
        <span class="n">private</span> <span class="n">static</span> <span class="n">readonly</span> <span class="n">log4net</span><span class="o">.</span><span class="n">ILog</span> <span class="n">Logger</span> <span class="o">=</span> <span class="n">log4net</span><span class="o">.</span><span class="n">LogManager</span><span class="o">.</span><span class="n">GetLogger</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">ReportPart</span><span class="p">));</span>

        <span class="n">public</span> <span class="n">string</span> <span class="n">ReportId</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="n">public</span> <span class="n">string</span> <span class="n">Token</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="n">protected</span> <span class="n">void</span> <span class="n">Page_Load</span><span class="p">(</span><span class="nb">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ReportId</span> <span class="o">=</span> <span class="p">(</span><span class="n">Page</span><span class="o">.</span><span class="n">RouteData</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">Empty</span><span class="p">);</span>
            <span class="n">Token</span> <span class="o">=</span> <span class="n">Request</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">];</span>

            <span class="n">Logger</span><span class="o">.</span><span class="n">DebugFormat</span><span class="p">(</span><span class="s2">&quot;Render report part id=</span><span class="si">{0}</span><span class="s2">, token=</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ReportId</span><span class="p">,</span> <span class="n">Token</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The properties in this code-behind are used to populate the arguments for the <code class="docutils literal"><span class="pre">izendaInitReportPartExportViewer</span></code> function.</p>
</div>
<div class="section" id="embedding-the-report-viewer">
<h4><a class="toc-backref" href="#id78">Embedding the Report Viewer</a><a class="headerlink" href="#embedding-the-report-viewer" title="Permalink to this headline">¶</a></h4>
<p>Create ~\Report\ReportViewer.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;Report Viewer&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;ReportViewer.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Report.ReportViewer&quot; %&gt;
&lt;asp:Content ID=&quot;ReportViewerContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
<span class="hll">            izendaInitReportViewer(&#39;&lt;%=ReportId%&gt;&#39;);
</span>        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
<p>Note from the highlighted line that this page also used by Izenda backend in function to export report html content when the user wants to send a report via email (directly or via the subscription scheduler). The Izenda backend uses the route <code class="docutils literal"><span class="pre">report/view/{id}</span></code> to get report content, then in RouteConfig.cs we have a custom route for this to map it to <code class="docutils literal"><span class="pre">Report/ReportViewer.aspx</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">UI</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Report</span>
<span class="p">{</span>
    <span class="n">public</span> <span class="n">partial</span> <span class="k">class</span> <span class="nc">ReportViewer</span> <span class="p">:</span> <span class="n">Page</span>
    <span class="p">{</span>
        <span class="n">private</span> <span class="n">static</span> <span class="n">readonly</span> <span class="n">log4net</span><span class="o">.</span><span class="n">ILog</span> <span class="n">Logger</span> <span class="o">=</span> <span class="n">log4net</span><span class="o">.</span><span class="n">LogManager</span><span class="o">.</span><span class="n">GetLogger</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">ReportViewer</span><span class="p">));</span>

        <span class="n">public</span> <span class="n">string</span> <span class="n">ReportId</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="n">protected</span> <span class="n">void</span> <span class="n">Page_Load</span><span class="p">(</span><span class="nb">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ReportId</span> <span class="o">=</span> <span class="p">(</span><span class="n">Page</span><span class="o">.</span><span class="n">RouteData</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">Empty</span><span class="p">);</span>
            <span class="n">Logger</span><span class="o">.</span><span class="n">DebugFormat</span><span class="p">(</span><span class="s2">&quot;Render Report ID=</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ReportId</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You must ensure your report viewer page handles the ID parameter passed in via the route data.</p>
</div>
<div class="section" id="embedding-report-parts">
<h4><a class="toc-backref" href="#id79">Embedding Report Parts</a><a class="headerlink" href="#embedding-report-parts" title="Permalink to this headline">¶</a></h4>
<p>This page demonstrates how to display multiple report parts on a page outside of the Report Viewer.  The function <code class="docutils literal"><span class="pre">izendaInitReportPartDemo</span></code> in ~\Scripts\izenda.integrate.js is implemented to handle this.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Render</span> <span class="n">report</span> <span class="n">parts</span> <span class="n">to</span> <span class="n">specific</span> <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span> <span class="n">tag</span> <span class="n">by</span> <span class="n">report</span> <span class="n">part</span> <span class="nb">id</span>
<span class="n">var</span> <span class="n">izendaInitReportPartDemo</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="n">function</span> <span class="n">successFunc</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="n">var</span> <span class="n">currentUserContext</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">token</span><span class="p">:</span> <span class="n">data</span>
        <span class="p">};</span>


        <span class="o">//</span> <span class="n">You</span> <span class="n">can</span> <span class="n">add</span> <span class="n">report</span> <span class="n">parts</span> <span class="n">after</span> <span class="n">creating</span> <span class="n">reports</span> <span class="n">using</span> <span class="n">the</span> <span class="n">context</span> <span class="n">below</span> 
        <span class="o">//</span> <span class="n">Add</span> <span class="n">the</span> <span class="n">report</span> <span class="n">part</span> <span class="n">ID</span><span class="s1">&#39;s in the &lt;reportPartIds&gt; array</span>
        <span class="n">var</span> <span class="n">reportPartIds</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Array</span><span class="p">(</span>
                <span class="s2">&quot;[your 1st report part id]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;[your 2nd report part id]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;[your 3rd report part id]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;[your 4th report part id]&quot;</span>
            <span class="p">);</span>

        <span class="n">IzendaSynergy</span><span class="o">.</span><span class="n">setCurrentUserContext</span><span class="p">(</span><span class="n">currentUserContext</span><span class="p">);</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">var</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">reportPartIds</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="o">//</span><span class="n">create</span> <span class="n">report</span> <span class="n">part</span> <span class="n">container</span>
            <span class="n">var</span> <span class="n">reportPartNode</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
            <span class="n">reportPartNode</span><span class="o">.</span><span class="n">className</span> <span class="o">=</span> <span class="s2">&quot;report-part-chart&quot;</span><span class="p">;</span>

            <span class="o">//</span><span class="n">Render</span> <span class="n">report</span> <span class="n">part</span>
            <span class="n">IzendaSynergy</span><span class="o">.</span><span class="n">renderReportPart</span><span class="p">(</span><span class="n">reportPartNode</span><span class="p">,</span> <span class="p">{</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">reportPartIds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">});</span>

            <span class="o">//</span><span class="n">Append</span> <span class="n">to</span> <span class="n">izenda</span><span class="o">-</span><span class="n">root</span> <span class="n">container</span>
            <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s1">&#39;izenda-root&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">reportPartNode</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">this</span><span class="o">.</span><span class="n">DoRender</span><span class="p">(</span><span class="n">successFunc</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Create ~\Report\ReportParts.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;Report Parts&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;ReportParts.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Report.ReportParts&quot; %&gt;

&lt;asp:Content ID=&quot;ReportPartsContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
<span class="hll">            izendaInitReportPartDemo();
</span>        });
    &lt;/script&gt;
    
    &lt;style&gt;
        .report-part-chart {
            float: left;
            width: 40%;
            height:  40%;
            margin-left: 20px;
            margin-top: 20px;
            background-color: white;
        }

        .report-part-grid {
            float: left;
            width: 40%;
            height:  50%;
            margin-left: 20px;
            margin-top: 20px;
            background-color: white;
        }
    &lt;/style&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="embedding-the-dashboard">
<h3><a class="toc-backref" href="#id80">Embedding the Dashboard</a><a class="headerlink" href="#embedding-the-dashboard" title="Permalink to this headline">¶</a></h3>
<div class="section" id="dashboard-list">
<h4><a class="toc-backref" href="#id81">Dashboard List</a><a class="headerlink" href="#dashboard-list" title="Permalink to this headline">¶</a></h4>
<p>This page displays the dashboard list.</p>
<p>Create ~\Dashboard\Dashboards.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;Dashboards&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;Dashboards.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Dashboard.Dashboards&quot; %&gt;
&lt;asp:Content ID=&quot;DashboardsContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
<span class="hll">            izendaInitDashboard();
</span>        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
</div>
<div class="section" id="new-dashboard">
<h4><a class="toc-backref" href="#id82">New Dashboard</a><a class="headerlink" href="#new-dashboard" title="Permalink to this headline">¶</a></h4>
<p>The page for creating a new dashboard.</p>
<p>Create ~\Dashboard\DashboardDesigner.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;New Dashboard&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;DashboardDesigner.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Dashboard.DashboardDesigner&quot; %&gt;
&lt;asp:Content ID=&quot;DashboardDesignerContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
<span class="hll">            izendaInitNewDashboard();
</span>        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
</div>
<div class="section" id="dashboard-viewer">
<h4><a class="toc-backref" href="#id83">Dashboard Viewer</a><a class="headerlink" href="#dashboard-viewer" title="Permalink to this headline">¶</a></h4>
<p>This page displays details of a dashboard. It is also requested by the Izenda backend for dashboard exporting functions over the route <code class="docutils literal"><span class="pre">dashboard/view/{id}</span></code>. In RouteConfig.cs we have a custom route named <code class="docutils literal"><span class="pre">DashboardViewer</span></code>. This custom route will map to the <code class="docutils literal"><span class="pre">dashboard/DashboardViewer.aspx</span></code> page.</p>
<p>Create ~Dashboard\DashboardViewer.aspx:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;%@ Page Title=&quot;&quot; Language=&quot;C#&quot; MasterPageFile=&quot;~/Site.Master&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;DashboardViewer.aspx.cs&quot; Inherits=&quot;WebFormsStarterKit.Dashboard.DashboardViewer&quot; %&gt;
&lt;asp:Content ID=&quot;DashboardViewerContent&quot; ContentPlaceHolderID=&quot;MainContent&quot; runat=&quot;server&quot;&gt;
     &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function () {
<span class="hll">            izendaInitDashboardViewer(&#39;&lt;%=DashboardId%&gt;&#39;);
</span>        });
    &lt;/script&gt;

    &lt;div class=&quot;loader&quot; id=&quot;progressLoader&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;izenda-container&quot; id=&quot;izenda-root&quot;&gt;&lt;/div&gt;
&lt;/asp:Content&gt;
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Web</span><span class="o">.</span><span class="n">UI</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Dashboard</span>
<span class="p">{</span>
    <span class="n">public</span> <span class="n">partial</span> <span class="k">class</span> <span class="nc">DashboardViewer</span> <span class="p">:</span> <span class="n">Page</span>
    <span class="p">{</span>
        <span class="n">private</span> <span class="n">static</span> <span class="n">readonly</span> <span class="n">log4net</span><span class="o">.</span><span class="n">ILog</span> <span class="n">Logger</span> <span class="o">=</span> <span class="n">log4net</span><span class="o">.</span><span class="n">LogManager</span><span class="o">.</span><span class="n">GetLogger</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">DashboardViewer</span><span class="p">));</span>

        <span class="n">public</span> <span class="n">string</span> <span class="n">DashboardId</span> <span class="p">{</span> <span class="n">get</span><span class="p">;</span> <span class="nb">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="n">protected</span> <span class="n">void</span> <span class="n">Page_Load</span><span class="p">(</span><span class="nb">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">DashboardId</span> <span class="o">=</span> <span class="p">(</span><span class="n">Page</span><span class="o">.</span><span class="n">RouteData</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">Empty</span><span class="p">);</span>
            <span class="n">Logger</span><span class="o">.</span><span class="n">DebugFormat</span><span class="p">(</span><span class="s2">&quot;Render Dashboard ID=</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">DashboardId</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The RouteData is used to handle incoming requests to pass the Dashboard Id into the javascript function.</p>
</div>
</div>
</div>
<div class="section" id="run-your-izenda-integrated-application">
<h2><a class="toc-backref" href="#id84">Run Your Izenda Integrated Application</a><a class="headerlink" href="#run-your-izenda-integrated-application" title="Permalink to this headline">¶</a></h2>
<p>Press F5 to run debug</p>
<p>Navigate to login page and enter the values below for the respective fields:</p>
<ul class="simple">
<li>Tenant = System</li>
<li>Email = <a class="reference external" href="mailto:IzendaAdmin&#37;&#52;&#48;system&#46;com">IzendaAdmin<span>&#64;</span>system<span>&#46;</span>com</a></li>
<li>Password = <a class="reference external" href="mailto:Izenda&#37;&#52;&#48;123">Izenda<span>&#64;</span>123</a></li>
</ul>
<p>On top menu click Settings link then add your license key</p>
<div class="figure" id="id11">
<a class="reference internal image-reference" href="../_images/webforms_license_key.png"><img alt="../_images/webforms_license_key.png" src="../_images/webforms_license_key.png" style="width: 900px;" /></a>
<p class="caption"><span class="caption-number">Fig. 442 </span><span class="caption-text">Settings license key</span></p>
</div>
<p>Stop your application and start it again (this step ensures Izenda reloads the cache).</p>
<p>Click Izenda link on the top menu to open the full Izenda app</p>
<div class="figure" id="id12">
<a class="reference internal image-reference" href="../_images/webforms_full_izenda_app.png"><img alt="../_images/webforms_full_izenda_app.png" src="../_images/webforms_full_izenda_app.png" style="width: 900px;" /></a>
<p class="caption"><span class="caption-number">Fig. 443 </span><span class="caption-text">Full Izenda app</span></p>
</div>
<p>Now feel free to explore the entire Izenda integrated application.</p>
</div>
<div class="section" id="implement-register-new-account">
<h2><a class="toc-backref" href="#id85">Implement Register New Account</a><a class="headerlink" href="#implement-register-new-account" title="Permalink to this headline">¶</a></h2>
<p>Modify Register.aspx</p>
<div class="figure" id="id13">
<a class="reference internal image-reference" href="../_images/webforms_new_account.png"><img alt="../_images/webforms_new_account.png" src="../_images/webforms_new_account.png" style="width: 900px;" /></a>
<p class="caption"><span class="caption-number">Fig. 444 </span><span class="caption-text">New account screen</span></p>
</div>
<p>Add a new Tenant TextBox field into ~\AcountRegister.aspx</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>        <span class="o">&lt;</span><span class="n">hr</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">ValidationSummary</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;text-danger&quot;</span> <span class="o">/&gt;</span>
<span class="hll">        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;form-group&quot;</span><span class="o">&gt;</span>
</span><span class="hll">            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">AssociatedControlID</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;col-md-2 control-label&quot;</span><span class="o">&gt;</span><span class="n">Tenant</span><span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span><span class="o">&gt;</span>
</span><span class="hll">            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;col-md-10&quot;</span><span class="o">&gt;</span>
</span><span class="hll">                <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">TextBox</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;form-control&quot;</span><span class="o">/&gt;</span>
</span><span class="hll">                <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">RequiredFieldValidator</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ControlToValidate</span><span class="o">=</span><span class="s2">&quot;Tenant&quot;</span>
</span><span class="hll">                    <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;text-danger&quot;</span> <span class="n">ErrorMessage</span><span class="o">=</span><span class="s2">&quot;The tenant field is required.&quot;</span> <span class="o">/&gt;</span>
</span><span class="hll">            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class="hll">        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span>        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;form-group&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">AssociatedControlID</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span> <span class="n">CssClass</span><span class="o">=</span><span class="s2">&quot;col-md-2 control-label&quot;</span><span class="o">&gt;</span><span class="n">Email</span><span class="o">&lt;/</span><span class="n">asp</span><span class="p">:</span><span class="n">Label</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Also, in accordance with the change to Login.aspx to properly nest it inside the form tag, change the ContentPlaceHolderID to the aforementioned placeholder:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">&lt;%@</span> <span class="n">Page</span> <span class="n">Title</span><span class="o">=</span><span class="s2">&quot;Register&quot;</span> <span class="n">Language</span><span class="o">=</span><span class="s2">&quot;C#&quot;</span> <span class="n">MasterPageFile</span><span class="o">=</span><span class="s2">&quot;~/Site.Master&quot;</span> <span class="n">AutoEventWireup</span><span class="o">=</span><span class="s2">&quot;true&quot;</span> <span class="n">CodeBehind</span><span class="o">=</span><span class="s2">&quot;Register.aspx.cs&quot;</span> <span class="n">Inherits</span><span class="o">=</span><span class="s2">&quot;WebFormsStarterKit.Account.Register&quot;</span> <span class="o">%&gt;</span>

<span class="hll"><span class="o">&lt;</span><span class="n">asp</span><span class="p">:</span><span class="n">Content</span> <span class="n">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span> <span class="n">ID</span><span class="o">=</span><span class="s2">&quot;BodyContent&quot;</span> <span class="n">ContentPlaceHolderID</span><span class="o">=</span><span class="s2">&quot;LoginContent&quot;</span><span class="o">&gt;</span>
</span>    <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;&lt;%</span><span class="p">:</span> <span class="n">Title</span> <span class="o">%&gt;.&lt;/</span><span class="n">h2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Create a new folder called &#8220;Managers&#8221; and Add a new class called &#8220;TenantManager&#8221; to your project (~\Managers\TenantManager.cs). This class is used to get Tenant information from your application&#8217;s database and create new tenant info for your authentication DB.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Linq</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Threading</span><span class="o">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="n">using</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Models</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">WebFormsStarterKit</span><span class="o">.</span><span class="n">Managers</span>
<span class="p">{</span>
    <span class="n">public</span> <span class="k">class</span> <span class="nc">TenantManager</span>
    <span class="p">{</span>
        <span class="n">public</span> <span class="n">Tenant</span> <span class="n">GetTenantByName</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">context</span> <span class="o">=</span> <span class="n">ApplicationDbContext</span><span class="o">.</span><span class="n">Create</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">var</span> <span class="n">tenant</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">Tenants</span><span class="o">.</span><span class="n">SingleOrDefault</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">Equals</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">StringComparison</span><span class="o">.</span><span class="n">InvariantCultureIgnoreCase</span><span class="p">));</span>
                <span class="k">return</span> <span class="n">tenant</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">public</span> <span class="n">Tenant</span> <span class="n">SaveTenant</span><span class="p">(</span><span class="n">Tenant</span> <span class="n">tenant</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">context</span> <span class="o">=</span> <span class="n">ApplicationDbContext</span><span class="o">.</span><span class="n">Create</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">context</span><span class="o">.</span><span class="n">Tenants</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">tenant</span><span class="p">);</span>
                <span class="n">context</span><span class="o">.</span><span class="n">SaveChanges</span><span class="p">();</span>

                <span class="k">return</span> <span class="n">tenant</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Open ~\AccountRegister.aspx.cs and modify the CreateUser_Click method to handle the new registration logic.</p>
<p>When registering a new user, the new user’s information is stored on both the authentication DB and the Izenda DB. To achieve this, we split the registration logic into the steps below:</p>
<ul class="simple">
<li>Save new Tenant if needed</li>
<li>Save User and Role in authentication DB</li>
<li>Save User and Role in Izenda DB</li>
<li>Sign in with new user</li>
</ul>
<p>All steps are encapsulated in the CreateUser_Click method of the Register.aspx.cs file.</p>
<p>Register tenant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>            <span class="n">var</span> <span class="n">tenant</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Tenant</span><span class="p">()</span> <span class="p">{</span> <span class="n">Name</span> <span class="o">=</span> <span class="n">Tenant</span><span class="o">.</span><span class="n">Text</span> <span class="p">};</span>
            <span class="n">var</span> <span class="n">tenantManager</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Managers</span><span class="o">.</span><span class="n">TenantManager</span><span class="p">();</span>
            <span class="n">var</span> <span class="n">exstingTenant</span> <span class="o">=</span> <span class="n">tenantManager</span><span class="o">.</span><span class="n">GetTenantByName</span><span class="p">(</span><span class="n">tenant</span><span class="o">.</span><span class="n">Name</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">exstingTenant</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span>
                <span class="n">tenant</span> <span class="o">=</span> <span class="n">exstingTenant</span><span class="p">;</span>
            <span class="k">else</span>
                <span class="n">tenant</span> <span class="o">=</span> <span class="n">tenantManager</span><span class="o">.</span><span class="n">SaveTenant</span><span class="p">(</span><span class="n">tenant</span><span class="p">);</span>
</pre></div>
</div>
<p>Save user and role information into authentication DB:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>            <span class="n">var</span> <span class="n">user</span> <span class="o">=</span> <span class="n">new</span> <span class="n">ApplicationUser</span><span class="p">()</span> <span class="p">{</span> <span class="n">UserName</span> <span class="o">=</span> <span class="n">Email</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">Email</span> <span class="o">=</span> <span class="n">Email</span><span class="o">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">Tenant_Id</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">Id</span> <span class="p">};</span>
            <span class="n">IdentityResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">Password</span><span class="o">.</span><span class="n">Text</span><span class="p">);</span>
            <span class="o">//</span><span class="n">This</span> <span class="n">line</span> <span class="n">below</span> <span class="n">will</span> <span class="n">hard</span> <span class="n">code</span> <span class="n">users</span> <span class="n">who</span> <span class="n">register</span> <span class="n">to</span> <span class="n">a</span> <span class="n">role</span> <span class="n">of</span> <span class="n">Manager</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">changed</span> <span class="n">by</span> <span class="n">altering</span> <span class="n">the</span> <span class="n">role</span> <span class="n">below</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">AddToRole</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">Id</span><span class="p">,</span> <span class="s2">&quot;Manager&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Save user and role into IzendaDB:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>            <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Succeeded</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="o">//</span><span class="n">izenda</span>

                <span class="o">//</span><span class="n">determine</span> <span class="n">tenant</span>
                <span class="n">var</span> <span class="n">izendaTenant</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Tenants</span><span class="p">();</span>
                <span class="n">izendaTenant</span><span class="o">.</span><span class="n">Active</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
                <span class="n">izendaTenant</span><span class="o">.</span><span class="n">Deleted</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>

                <span class="o">//</span><span class="n">var</span> <span class="n">currentUserTenant</span> <span class="o">=</span> <span class="n">ParseTenantFromEmail</span><span class="p">(</span><span class="n">izendaTenant</span><span class="o">.</span><span class="n">Name</span><span class="p">);</span>
                <span class="n">izendaTenant</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">Name</span><span class="p">;</span>
                <span class="n">izendaTenant</span><span class="o">.</span><span class="n">TenantID</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">Name</span><span class="p">;</span>

                <span class="o">//</span><span class="n">determine</span> <span class="n">roles</span>
                <span class="n">var</span> <span class="n">roleDetail</span> <span class="o">=</span> <span class="n">new</span> <span class="n">RoleDetail</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">,</span>
                    <span class="n">TenantUniqueName</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="n">true</span><span class="p">,</span>
                    <span class="n">Permission</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Permission</span><span class="p">(),</span>
                <span class="p">};</span>

                <span class="n">var</span> <span class="n">izendaUser</span> <span class="o">=</span> <span class="n">new</span> <span class="n">UserDetail</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">UserName</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">Email</span><span class="p">,</span>
                    <span class="n">EmailAddress</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">Email</span><span class="p">,</span>
                    <span class="n">FirstName</span> <span class="o">=</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="o">//</span><span class="n">todo</span> <span class="n">fix</span> <span class="n">this</span>
                    <span class="n">LastName</span> <span class="o">=</span> <span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
                    <span class="n">TenantDisplayId</span> <span class="o">=</span> <span class="n">tenant</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
                    <span class="n">Deleted</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span>
                    <span class="n">Active</span> <span class="o">=</span> <span class="n">true</span><span class="p">,</span>
                    <span class="n">SystemAdmin</span> <span class="o">=</span> <span class="n">false</span><span class="p">,</span>
                    <span class="n">Roles</span> <span class="o">=</span> <span class="n">new</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span><span class="p">()</span>
                <span class="p">};</span>

                <span class="n">izendaUser</span><span class="o">.</span><span class="n">Roles</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">new</span> <span class="n">Role</span><span class="p">()</span>
                <span class="p">{</span>
                    <span class="n">Name</span> <span class="o">=</span> <span class="n">roleDetail</span><span class="o">.</span><span class="n">Name</span>
                <span class="p">});</span>

                <span class="n">TenantIntegrationConfig</span><span class="o">.</span><span class="n">AddOrUpdateTenant</span><span class="p">(</span><span class="n">izendaTenant</span><span class="p">);</span>
                <span class="n">RoleIntegrationConfig</span><span class="o">.</span><span class="n">AddOrUpdateRole</span><span class="p">(</span><span class="n">roleDetail</span><span class="p">);</span>
                <span class="n">UserIntegrationConfig</span><span class="o">.</span><span class="n">AddOrUpdateUser</span><span class="p">(</span><span class="n">izendaUser</span><span class="p">);</span>
</pre></div>
</div>
<p>Login with newly created user:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>                <span class="n">signInManager</span><span class="o">.</span><span class="n">SignIn</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">isPersistent</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="n">rememberBrowser</span><span class="p">:</span> <span class="n">false</span><span class="p">);</span>
                <span class="n">IdentityHelper</span><span class="o">.</span><span class="n">RedirectToReturnUrl</span><span class="p">(</span><span class="n">Request</span><span class="o">.</span><span class="n">QueryString</span><span class="p">[</span><span class="s2">&quot;ReturnUrl&quot;</span><span class="p">],</span> <span class="n">Response</span><span class="p">);</span>
</pre></div>
</div>
<p>You can refer to completed implementation of the Register logic on Github <a class="reference external" href="https://github.com/Izenda7Series/WebFormsStarterkit/blob/master/WebFormsStarterKit/Account/Register.aspx.cs">here</a>.</p>
</div>
<div class="section" id="call-the-izenda-api-service-in-c">
<h2><a class="toc-backref" href="#id86">Call the Izenda API Service in C#</a><a class="headerlink" href="#call-the-izenda-api-service-in-c" title="Permalink to this headline">¶</a></h2>
<p>In the completed sample starter kit on Github, we provide an example demonstrating how to call Izenda&#8217;s API service in C# code. Reference the ~\IzendaBoundary\WebAPIService.cs and ~\IzendaBoundary\IzendaUtility.cs files for more detail.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dev_front_end_considerations.html" class="btn btn-neutral float-right" title="Front End Rendering Considerations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="howto_mvc5kit.html" class="btn btn-neutral" title="Deployment Mode 3: Building the MVC Starter Kit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Izenda.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.11.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75560-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-75560-1');
</script>



</body>
</html>